<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>A simple introduction to zfit &#8212; zfit 0.0.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Space" href="space.html" />
    <link rel="prev" title="Welcome to zfit’s documentation!" href="index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="index.html">
          zfit</a>
        <span class="navbar-text pull-left"><b>0.0.0</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="#">Getting started</a></li>
                <li><a href="space.html">Space</a></li>
                <li><a href="parameter.html">Parameter</a></li>
                <li><a href="model.html">Model</a></li>
                <li><a href="data.html">Data</a></li>
                <li><a href="loss.html">Loss</a></li>
                <li><a href="minimize.html">Minimize</a></li>
                <li><a href="API.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">A simple introduction to <code class="docutils literal notranslate"><span class="pre">zfit</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="space.html">Space</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Building a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimize.html">Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">zfit API documentation</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="span12 content">
      
  <div class="section" id="a-simple-introduction-to-zfit">
<h1>A simple introduction to <code class="docutils literal notranslate"><span class="pre">zfit</span></code><a class="headerlink" href="#a-simple-introduction-to-zfit" title="Permalink to this headline">¶</a></h1>
<p>The <code class="docutils literal notranslate"><span class="pre">zfit</span></code> package is a model fitting library based on TensorFlow and optimised for simple and direct manipulation of probability density functions. The main focus is on the scalability, parallelisation and user friendly experience (no cython, no C++ needed to extend) framework. The basic idea is to provide a pythonic oriented alternative to
the very successful <code class="docutils literal notranslate"><span class="pre">RooFit</span></code> libray from the ROOT (or even pyROOT) data analysis package. While <code class="docutils literal notranslate"><span class="pre">RooFit</span></code> has provided the a stable plattform for most of the need of the High Energy Physics community in the last few years, the</p>
<p>In this quick tutorial, we’ll show the basic ideas on what you can do with <cite>zfit</cite>, without going into much detail or performing advanced tasks.</p>
<p>First, we will perform the basic imports that we will use along most of the tutorials, and we’ll check the <cite>tensorflow</cite> version.</p>
<p>import numpy as np
import tensorflow as tf</p>
<p>import zfit
# Wrapper for some tensorflow functionality
from zfit import ztf
print(“TensorFlow version:”, tf.__version__)</p>
<p>## Create observables</p>
<p>The observable space in which PDFs are defined is created with the <cite>Space</cite> class,</p>
<p>obs = zfit.Space(‘x’, limits=(-10, 10))</p>
<p>## Create data</p>
<p>We need to create some data using <cite>numpy</cite>.</p>
<p>mu_true = 0.
sigma_true = 1.
data_np = np.random.normal(mu_true, sigma_true, size=10000)
data = zfit.data.Data.from_numpy(obs=obs, array=data_np)
print(data)</p>
<p>## Create a PDF to fit</p>
<p>Now let’s create a Gaussian PDF so we can fit the dataset. To do this, first we create the fit parameters, which follow a convention similar to <cite>RooFit</cite>:</p>
<p><code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">zfit.Parameter(name,</span> <span class="pre">initial_value,</span> <span class="pre">lower_limit</span> <span class="pre">(optional),</span> <span class="pre">upper_limit</span> <span class="pre">(optional),</span> <span class="pre">other</span> <span class="pre">options)</span>
<span class="pre">`</span></code></p>
<p>mu = zfit.Parameter(“mu”, 2.4, -1., 5.)
sigma = zfit.Parameter(“sigma”, 1.3, 0, 5.)</p>
<p>Now we instantiate a Gaussian from the zfit PDF library (more on how to create your own PDFs later)</p>
<p>gauss = zfit.pdf.Gauss(obs=obs, mu=mu, sigma=sigma)</p>
<p>This object object contains all the functions you would expect from a PDF, such as calculating a probability, calculating its integral, etc.</p>
<p><strong>NB</strong>: Currently, one important caveat is that all <cite>zfit</cite> objects are based on <cite>tensorflow</cite>, and therefore they are graphs that are not executed immediately, but need to be run on a session:</p>
<p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">zfit.run(TensorFlow_object)</span>
<span class="pre">`</span></code></p>
<p># Now, get some probability values
# The probs object is not executed yet
consts = [-1, 0, 1]
probs = gauss.pdf(ztf.constant(consts), norm_range=(-np.infty, np.infty))
# And now execute the tensorflow graph
result = zfit.run(probs)
print(“x values: {}nresult:   {}”.format(consts, result))</p>
<p>## Fitting</p>
<p>To fit, we need to take three steps (<strong>to be fixed in the future</strong>): create the negative $logmathcal{L}$, instantiate a minimizer and then minimize the likelihood.</p>
<p><em>Note</em>: IN this case, we don’t need to execut the graph (we need to make this consistent)</p>
<p># Create the negative log likelihood
from zfit.core.loss import UnbinnedNLL</p>
<p>nll = UnbinnedNLL(model=[gauss], data=[data], fit_range=[obs])</p>
<p># Load and instantiate a tensorflow minimizer
from zfit.minimizers.minimizer_minuit import MinuitMinimizer
minimizer = MinuitMinimizer()</p>
<p># Create the minimization graph to minimize mu and sigma and run it (minimize does it directly)
minimum = minimizer.minimize(loss=nll, params=[mu, sigma])</p>
<p># Get the fitted values, again by run the variable graphs
params = minimum.params</p>
<p>print(params)</p>
<p>%matplotlib inline</p>
<p>import matplotlib.pyplot as plt
n_bins = 50
<a href="#id3"><span class="problematic" id="id4">range_</span></a> = (-5,5)
_ = plt.hist(data_np, bins=n_bins, range=range_)
x = np.linspace(<a href="#id1"><span class="problematic" id="id2">*</span></a><a href="#id5"><span class="problematic" id="id6">range_</span></a>, num=1000)
pdf = zfit.run(gauss.pdf(x, norm_range=(-10, 10)))
#_ = plt.plot(x, data_np.shape[0]/n_bins*10.*pdf[0,:])</p>
<p>Here, we can see the power of the context managers used to change the normalisation range.</p>
<p>with gauss.set_norm_range((-1e6, 1e6)):  # play around with different norm ranges
# with gauss.set_norm_range((-100, 100)):</p>
<blockquote>
<div>print(zfit.run(gauss.integrate((-0.6, 0.6))))
print(zfit.run(gauss.integrate((-3, 3))))
print(zfit.run(gauss.integrate((-100, 100))))</div></blockquote>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, zfit.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>