<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>zfit: scalable pythonic fitting &#8212; zfit 0.0.0 documentation</title>
    <link rel="stylesheet" href="_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/js/jquery-1.11.0.min.js"></script>
    <script type="text/javascript" src="_static/js/jquery-fix.js"></script>
    <script type="text/javascript" src="_static/bootstrap-2.3.2/js/bootstrap.min.js"></script>
    <script type="text/javascript" src="_static/bootstrap-sphinx.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="index.html">
          zfit</a>
        <span class="navbar-text pull-left"><b>0.0.0</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="getting_started.html">Getting started</a></li>
                <li><a href="space.html">Space</a></li>
                <li><a href="parameter.html">Parameter</a></li>
                <li><a href="model.html">Model</a></li>
                <li><a href="data.html">Data</a></li>
                <li><a href="loss.html">Loss</a></li>
                <li><a href="minimize.html">Minimize</a></li>
                <li><a href="API.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="getting_started.html">Getting started with zfit</a></li>
<li class="toctree-l1"><a class="reference internal" href="downloading.html">Downloading and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="space.html">Space, Observable and Range</a></li>
<li class="toctree-l1"><a class="reference internal" href="parameter.html">Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Building a model</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="loss.html">Loss</a></li>
<li class="toctree-l1"><a class="reference internal" href="minimize.html">Minimization</a></li>
<li class="toctree-l1"><a class="reference internal" href="API.html">zfit API documentation</a></li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="span12 content">
      
  <div class="section" id="zfit-scalable-pythonic-fitting">
<h1>zfit: scalable pythonic fitting<a class="headerlink" href="#zfit-scalable-pythonic-fitting" title="Permalink to this headline">¶</a></h1>
<a class="reference external image-reference" href="https://pypi.python.org/pypi/zfit"><img alt="https://img.shields.io/pypi/v/zfit.svg" src="https://img.shields.io/pypi/v/zfit.svg" /></a>
<a class="reference external image-reference" href="https://travis-ci.org/zfit/zfit"><img alt="https://img.shields.io/travis/zfit/zfit.svg" src="https://img.shields.io/travis/zfit/zfit.svg" /></a>
<a class="reference external image-reference" href="https://coveralls.io/github/zfit/zfit?branch=meta_changes"><img alt="https://coveralls.io/repos/github/zfit/zfit/badge.svg?branch=meta_changes" src="https://coveralls.io/repos/github/zfit/zfit/badge.svg?branch=meta_changes" /></a>
<a class="reference external image-reference" href="https://www.codefactor.io/repository/github/zfit/zfit"><img alt="CodeFactor" src="https://www.codefactor.io/repository/github/zfit/zfit/badge" /></a>
<p>The zfit package is a model manipulation and fitting library based on <a class="reference external" href="https://www.tensorflow.org/">TensorFlow</a> and optimised for simple and direct manipulation of probability density functions.
Its main focus is on scalability, parallelisation and user friendly experience.</p>
<p>Detailed documentation, including the API, can be found in <a class="reference external" href="https://zfit.github.io/zfit">https://zfit.github.io/zfit</a>.</p>
<p>It is released as free software following the BSD-3-Clause License.</p>
<p><em>N.B.</em>: zfit is currently in beta stage, so while most core parts are established, some may still be missing and bugs may be encountered.
It is, however, mostly ready for production, and is being used in a few analysis projects.
If you want to use it for your project and you are not sure if all the needed functionality is there, feel free contact us in our <a class="reference external" href="https://gitter.im/zfit/zfit">Gitter channel</a>.</p>
<div class="section" id="why">
<h2>Why?<a class="headerlink" href="#why" title="Permalink to this headline">¶</a></h2>
<p>The basic idea behind zfit is to offer a Python oriented alternative to the very successful RooFit library from the <a class="reference external" href="https://root.cern.ch/">ROOT</a> data analysis package that can integrate with the other packages that are part if the scientific Python ecosystem.
Contrary to the monolithic approach of ROOT/RooFit, the aim of zfit is to be light and flexible enough to integrate with any state-of-art tools and to allow scalability going to larger datasets.</p>
<p>These core ideas are supported by two basic pillars:</p>
<ul class="simple">
<li>The skeleton and extension of the code is minimalist, simple and finite:
the zfit library is exclusively designed for the purpose of model fitting and sampling with no attempt to extend its functionalities to features such as statistical methods or plotting.</li>
<li>zfit is designed to for optimal parallelisation and scalability by making use of TensorFlow as its backend.
Even though this choice introduces a strong software dependency, we believe the use of TensorFlow provides crucial features in the context of model fitting.</li>
</ul>
</div>
<div class="section" id="installing">
<h2>Installing<a class="headerlink" href="#installing" title="Permalink to this headline">¶</a></h2>
<p>To install zfit, run this command in your terminal:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install zfit
</pre></div>
</div>
<p>This is the preferred method to install zfit, as it will always install the most recent stable release.</p>
<p>For the newest development version (in case you really need it), you can install the version from git with</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="gp">$</span> pip install git+https://github.com/zfit/zfit
</pre></div>
</div>
</div>
<div class="section" id="how-to-use">
<h2>How to use<a class="headerlink" href="#how-to-use" title="Permalink to this headline">¶</a></h2>
<p>While the zfit library provides a simple model fitting and sampling framework for a broad list of applications, we will illustrate its main features by generating, fitting and ploting a Gaussian distribution.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">tensorflow</span> <span class="kn">as</span> <span class="nn">tf</span>
<span class="kn">import</span> <span class="nn">zfit</span>
<span class="kn">from</span> <span class="nn">zfit</span> <span class="kn">import</span> <span class="n">ztf</span>
</pre></div>
</div>
<p>The domain of the PDF is defined by an <em>observable space</em>, which is created using the <code class="docutils literal notranslate"><span class="pre">zfit.Space</span></code> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>Using this domain, we can now create a simple Gaussian PDF. To do this, we define its parameters and their limits using the <code class="docutils literal notranslate"><span class="pre">zfit.Parameter</span></code> class and we instantiate the PDF from the zfit library:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mu</span>    <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span>   <span class="p">,</span> <span class="mf">2.4</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mf">1.3</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="n">gauss</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">)</span>
</pre></div>
</div>
<p>For simplicity, we create the dataset to be fitted starting from a numpy array, but zfit allows for the use of other sources such as ROOT files:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mu_true</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">sigma_true</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">data_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">mu_true</span><span class="p">,</span> <span class="n">sigma_true</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">Data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">data_np</span><span class="p">)</span>
</pre></div>
</div>
<p>Fits are performed in three steps:</p>
<ol class="arabic simple">
<li>Creation of a loss function, in our case a negative log-likelihood.</li>
<li>Instantiation of our choice of minimiser, in the example the <code class="docutils literal notranslate"><span class="pre">MinuitMinimizer</span></code>.</li>
<li>Minimisation of the loss function.</li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Stage 1: create an unbinned likelihood with the given PDF and dataset</span>
<span class="n">nll</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">gauss</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>

<span class="c1"># Stage 2: instantiate a minimiser (in this case a basic minuit</span>
<span class="n">minimizer</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">minimize</span><span class="o">.</span><span class="n">MinuitMinimizer</span><span class="p">()</span>

<span class="c1"># Stage 3: minimise the given negative likelihood</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">nll</span><span class="p">)</span>
</pre></div>
</div>
<p>Errors are calculated with a further function call to avoid running potentially expensive operations if not needed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">param_errors</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">error</span><span class="p">()</span>
</pre></div>
</div>
<p>Once we’ve performed the fit and obtained the corresponding uncertainties, we can examine the fit results:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">print</span><span class="p">(</span><span class="s2">&quot;Function minimum:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">fmin</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Converged:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">converged</span><span class="p">)</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;Full minimizer information:&quot;</span><span class="p">,</span> <span class="n">result</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>

<span class="c1"># Information on all the parameters in the fit</span>
<span class="n">params</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">params</span>
<span class="k">print</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

<span class="c1"># Printing information on specific parameters, e.g. mu</span>
<span class="k">print</span><span class="p">(</span><span class="s2">&quot;mu={}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">params</span><span class="p">[</span><span class="n">mu</span><span class="p">][</span><span class="s1">&#39;value&#39;</span><span class="p">]))</span>
</pre></div>
</div>
<p>And that’s it!
For more details and information of what you can do with zfit, please see the <a class="reference external" href="https://zfit.github.io/zfit">documentation page</a>.</p>
</div>
<div class="section" id="contributing">
<h2>Contributing<a class="headerlink" href="#contributing" title="Permalink to this headline">¶</a></h2>
<p>Contributions are always welcome, please have a look at the <a class="reference external" href="CONTRIBUTING.rst">Contributing guide</a>.</p>
</div>
<div class="section" id="acknowledgements">
<h2>Acknowledgements<a class="headerlink" href="#acknowledgements" title="Permalink to this headline">¶</a></h2>
<p>zfit has been developed with support from the University of Zürich and the Swiss National Science Foundation (SNSF) under contracts 168169 and 174182.</p>
<p>The zfit structure is based on the <a class="reference external" href="https://gitlab.cern.ch/poluekt/TensorFlowAnalysis">TensorFlowAnalysis</a> framework developed by Anton Poluektov using the TensorFlow open source library.</p>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2018, zfit.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.8.5.<br/>
    </p>
  </div>
</footer>
  </body>
</html>