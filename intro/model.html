<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Building a model &#8212; zfit 0.4.2.dev18+g27cee35 documentation</title>
    <link rel="stylesheet" href="../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Data" href="data.html" />
    <link rel="prev" title="Parameter" href="parameter.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../_static/bootstrap-2.3.2/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../index.html">
          zfit</a>
        <span class="navbar-text pull-left"><b>0.4.2.dev18</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../getting_started.html">Getting started</a></li>
                <li><a href="../introduction.html">Intro</a></li>
                <li><a href="../project.html">Project</a></li>
                <li><a href="../API.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../index.html">Overview <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../getting_started.html">Getting started with zfit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../getting_started.html#what-did-just-happen">What did just happen?</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../introduction.html">zfit introduction</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="space.html">Space, Observable and Range</a><ul>
<li class="toctree-l3"><a class="reference internal" href="space.html#definitions">Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="space.html#limits">Limits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="space.html#defining-limits">Defining limits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="parameter.html">Parameter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="parameter.html#independent-parameter">Independent Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="parameter.html#dependent-parameter">Dependent Parameter</a></li>
</ul>
</li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Building a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#predefined-pdfs-and-basic-properties">Predefined PDFs and basic properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="#composite-pdf">Composite PDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#extended-pdf">Extended PDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-pdf">Custom PDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sampling-from-a-model">Sampling from a Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="#tensor-sampling">Tensor sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#playing-with-toys-multiple-samplings">Playing with toys: Multiple samplings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="data.html">Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="data.html#import-dataset-from-a-root-file">Import dataset from a ROOT file</a></li>
<li class="toctree-l3"><a class="reference internal" href="data.html#import-dataset-from-a-pandas-dataframe-or-numpy-ndarray">Import dataset from a pandas DataFrame or Numpy ndarray</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="loss.html">Loss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="loss.html#adding-constraints">Adding constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="loss.html#simultaneous-fits">Simultaneous fits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="minimize.html">Minimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="minimize.html#baseline-minimizers">Baseline minimizers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../project.html">zfit Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../project/installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/installation.html#stable-release">Stable release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/installation.html#from-sources">From sources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/upgrade_guide.html">Upgrade guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/upgrade_guide.html#upgrade-from-zfit-0-3-x-to-0-4-0">Upgrade from zfit 0.3.x to 0.4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/upgrade_guide.html#dependents">Dependents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/changelog.html">Changelog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#develop">Develop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#major-features-and-improvements">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#behavioral-changes">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#bug-fixes-and-small-changes">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#requirement-changes">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#thanks">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id1">0.4.1 (12.1.20)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id2">Major Features and Improvements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id3">0.4.0 (7.1.2020)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id4">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id5">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id6">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id7">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id8">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id9">0.3.7 (6.12.19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id10">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id11">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id12">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id13">Requirement changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id14">0.3.6 (12.10.19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id15">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id16">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id17">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id18">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id19">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id20">0.3.4 (30-07-19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id21">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id22">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id23">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#id24">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id25">0.3.3 (15-05-19)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id26">0.3.2 (01-05-19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#breaking-changes">Breaking changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#bugfixes">Bugfixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../project/changelog.html#improvements">Improvements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id27">0.3.1 (30-04-19)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id28">0.3.0 (2019-03-20)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../project/changelog.html#id29">0.0.1 (2018-03-22)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../project/authors.html">Development Lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/authors.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../project/authors.html#contributors">Contributors</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../API.html">zfit API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.html">zfit package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/zfit.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.core.html">core</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/zfit.core.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.basefunc.html">basefunc</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.basemodel.html">basemodel</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.baseobject.html">baseobject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.basepdf.html">basepdf</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../api/zfit.core.basepdf.html#defining-your-own-pdf">Defining your own pdf</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.constraint.html">constraint</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.data.html">data</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.dependents.html">dependents</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.dimension.html">dimension</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.integration.html">integration</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.interfaces.html">interfaces</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.limits.html">limits</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.loss.html">loss</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.operations.html">operations</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.parameter.html">parameter</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.sample.html">sample</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.core.testing.html">testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.minimizers.html">minimizers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/zfit.minimizers.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.base_tf.html">base_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.baseminimizer.html">baseminimizer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.fitresult.html">fitresult</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.interface.html">interface</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.minimizer_minuit.html">minimizer_minuit</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.minimizer_tfp.html">minimizer_tfp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.minimizers_scipy.html">minimizers_scipy</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.optimizers_tf.html">optimizers_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.minimizers.tf_external_optimizer.html">tf_external_optimizer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.models.html">models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/zfit.models.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.basefunctor.html">basefunctor</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.basic.html">basic</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.dist_tfp.html">dist_tfp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.functions.html">functions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.functor.html">functor</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.physics.html">physics</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.polynomials.html">polynomials</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.models.special.html">special</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.util.html">util</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/zfit.util.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.cache.html">cache</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../api/zfit.util.cache.html#basic-principle">Basic principle</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.checks.html">checks</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.container.html">container</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.diverse.html">diverse</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.exception.html">exception</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.execution.html">execution</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.graph.html">graph</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.logging.html">logging</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.temporary.html">temporary</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.util.ztyping.html">ztyping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.html">z</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../api/zfit.z.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.const.html">const</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.math.html">math</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.random.html">random</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.tools.html">tools</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.wrapping_tf.html">wrapping_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../api/zfit.z.zextension.html">zextension</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../api/zfit.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.constraint.html">constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.data.html">data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.func.html">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.loss.html">loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.minimize.html">minimize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.param.html">param</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.pdf.html">pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.sample.html">sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.settings.html">settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.pdf.html">pdf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.func.html">func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.data.html">data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.loss.html">loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.constraint.html">constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.minimize.html">minimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.minimizers.fitresult.html">fitresult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.settings.html">settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api/zfit.z.html">z</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../api/zfit.z.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.const.html">const</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.math.html">math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.random.html">random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.tools.html">tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.wrapping_tf.html">wrapping_tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../api/zfit.z.zextension.html">zextension</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"><ul>
<li><a class="reference internal" href="#">Building a model</a><ul>
<li><a class="reference internal" href="#predefined-pdfs-and-basic-properties">Predefined PDFs and basic properties</a></li>
<li><a class="reference internal" href="#composite-pdf">Composite PDF</a></li>
<li><a class="reference internal" href="#extended-pdf">Extended PDF</a></li>
<li><a class="reference internal" href="#custom-pdf">Custom PDF</a><ul>
<li><a class="reference internal" href="#sampling-from-a-model">Sampling from a Model</a></li>
<li><a class="reference internal" href="#tensor-sampling">Tensor sampling</a></li>
<li><a class="reference internal" href="#playing-with-toys-multiple-samplings">Playing with toys: Multiple samplings</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body span12 content" role="main">
      
  <div class="section" id="building-a-model">
<h1>Building a model<a class="headerlink" href="#building-a-model" title="Permalink to this headline">¶</a></h1>
<p>In order to build a generic model the concept of function and distributed density functions (PDFs) need to be clarified.
The PDF, or density of a continuous random variable, of X is a function f(x) that describes the relative likelihood for this random variable to take on a given value.
In this sense, for any two numbers a and b with <span class="math notranslate nohighlight">\(a \leq b\)</span>,</p>
<p><span class="math notranslate nohighlight">\(P(a \leq X \leq b) = \int^{b}_{a}f(X)dx\)</span></p>
<p>That is, the probability that X takes on a value in the interval <span class="math notranslate nohighlight">\([a, b]\)</span> is the area above this interval and under the graph of the density function.
In other words, in order to a function to be a PDF it must satisfy two criteria:
1. <span class="math notranslate nohighlight">\(f(x) \geq 0\)</span> for all x;
2. <span class="math notranslate nohighlight">\(\int^{\infty}_{-\infty}f(x)dx =\)</span> are under the entire graph of <span class="math notranslate nohighlight">\(f(x)=1\)</span>.
In zfit these distinctions are respected, <em>i.e.</em>, a function can be converted into a PDF by imposing the basic two criteria above… _basic-model:</p>
<div class="section" id="predefined-pdfs-and-basic-properties">
<h2>Predefined PDFs and basic properties<a class="headerlink" href="#predefined-pdfs-and-basic-properties" title="Permalink to this headline">¶</a></h2>
<p>A series of predefined PDFs are available to the users and can be easily accessed using autocompletion (if available). In fact, all of these can also be seen in</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">__all__</span><span class="p">)</span>
<span class="go">[&#39;BasePDF&#39;, &#39;BaseFunctor&#39;, &#39;Exponential&#39;, &#39;CrystalBall&#39;, &#39;DoubleCB&#39;, &#39;Gauss&#39;, &#39;Uniform&#39;, &#39;TruncatedGauss&#39;, &#39;WrapDistribution&#39;, &#39;Chebyshev&#39;, &#39;Legendre&#39;, &#39;Chebyshev2&#39;, &#39;Hermite&#39;, &#39;Laguerre&#39;, &#39;RecursivePolynomial&#39;, &#39;ProductPDF&#39;, &#39;SumPDF&#39;, &#39;ZPDF&#39;, &#39;SimplePDF&#39;, &#39;SimpleFunctorPDF&#39;]</span>
</pre></div>
</div>
<p>These include the basic function but also some operations discussed below. Let’s consider the simple example of a <code class="docutils literal notranslate"><span class="pre">CrystalBall</span></code>.
PDF objects must also be initialised giving their named parameters. For example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">4800</span><span class="p">,</span> <span class="mi">6000</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Creating the parameters for the crystal ball</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu&quot;</span><span class="p">,</span> <span class="mi">5279</span><span class="p">,</span> <span class="mi">5100</span><span class="p">,</span> <span class="mi">5300</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma&quot;</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;n&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Single crystal Ball</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_cb</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">CrystalBall</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">a</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case the CB object corresponds to a normalised PDF. The main properties of a PDF, e.g. the probability for a given normalisation range or even
to set a temporary normalisation range can be given as</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Get the probabilities of some random generated events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span> <span class="o">=</span> <span class="n">model_cb</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># And now execute the tensorflow graph</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="n">probs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">[3.34187765e-05 3.34196917e-05 3.34202989e-05 3.34181458e-05</span>
<span class="go"> 3.34172973e-05 3.34209238e-05 3.34164538e-05 3.34210950e-05</span>
<span class="go"> 3.34201199e-05 3.34209360e-05]</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The norm range of the pdf can be changed any time by</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_cb</span><span class="o">.</span><span class="n">set_norm_range</span><span class="p">((</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">6000</span><span class="p">))</span>
</pre></div>
</div>
<p>Another feature for the PDF is to calculate its integral in a certain limit. This can be easily achieved by</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Calculate the integral between 5000 and 5250 over the PDF normalized</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integral_norm</span> <span class="o">=</span> <span class="n">model_cb</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="mi">5000</span><span class="p">,</span> <span class="mi">5250</span><span class="p">))</span>
</pre></div>
</div>
<p>In this case the CB has been normalised using the range defined in the observable.
Conversely, the <code class="docutils literal notranslate"><span class="pre">norm_range</span></code> in which the PDF is normalised can also be specified as input.</p>
</div>
<div class="section" id="composite-pdf">
<h2>Composite PDF<a class="headerlink" href="#composite-pdf" title="Permalink to this headline">¶</a></h2>
<p>A common feature in building composite models it the ability to combine in terms of sum and products different PDFs.
There are two ways to create such models, either with the class API or with simple Python syntax.
Let’s consider a second crystal ball with the same mean position and width, but different tail parameters</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># New tail parameters for the second CB</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;a2&quot;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;n2&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># New crystal Ball function defined in the same observable range</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_cb2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">CrystalBall</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">a2</span><span class="p">,</span> <span class="n">n</span><span class="o">=</span><span class="n">n2</span><span class="p">)</span>
</pre></div>
</div>
<p>We can now combine these two PDFs to create a double Crystal Ball with a single mean and width, either using arithmetic operations</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First needs to define a parameters that represent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># the relative fraction between the two PDFs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">frac</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;frac&quot;</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Two different ways to combine</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_cb</span> <span class="o">=</span> <span class="n">frac</span> <span class="o">*</span> <span class="n">model_cb</span> <span class="o">+</span> <span class="n">model_cb2</span>
</pre></div>
</div>
<p>Or through the <a class="reference internal" href="../api/zfit.pdf.html#zfit.pdf.SumPDF" title="zfit.pdf.SumPDF"><code class="xref py py-class docutils literal notranslate"><span class="pre">zfit.pdf.SumPDF</span></code></a> class:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># or via the class API</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">double_cb_class</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">SumPDF</span><span class="p">(</span><span class="n">pdfs</span><span class="o">=</span><span class="p">[</span><span class="n">model_cb</span><span class="p">,</span> <span class="n">model_cb2</span><span class="p">],</span> <span class="n">fracs</span><span class="o">=</span><span class="n">frac</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice that the new PDF has the same observables as the original ones, as they coincide.
Alternatively one could consider having PDFs for different axis, which would then create a totalPDF with higher dimension.</p>
<p>A simple extension of these operations is if we want to instead of a sum of PDFs, to model a two-dimensional Gaussian (e.g.):</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Defining two Gaussians in two different axis (obs)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mu1</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu1&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma1</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma1&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gauss1</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="s2">&quot;obs1&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu1</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma1</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mu2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mu2&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sigma2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;sigma2&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gauss2</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">Gauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="s2">&quot;obs2&quot;</span><span class="p">,</span> <span class="n">mu</span><span class="o">=</span><span class="n">mu2</span><span class="p">,</span> <span class="n">sigma</span><span class="o">=</span><span class="n">sigma2</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Producing the product of two PDFs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prod_gauss</span> <span class="o">=</span> <span class="n">gauss1</span> <span class="o">*</span> <span class="n">gauss2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or alternatively</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prod_gauss_class</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">ProductPDF</span><span class="p">(</span><span class="n">pdfs</span><span class="o">=</span><span class="p">[</span><span class="n">gauss2</span><span class="p">,</span> <span class="n">gauss1</span><span class="p">])</span>  <span class="c1"># notice the different order or the pdf</span>
</pre></div>
</div>
<p>The new PDF is now in two dimensions.
The order of the observables follows the order of the PDFs given.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;python syntax product obs&quot;</span><span class="p">,</span> <span class="n">prod_gauss</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
<span class="go">[python syntax product obs (&#39;obs1&#39;, &#39;obs2&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;class API product obs&quot;</span><span class="p">,</span> <span class="n">prod_gauss_class</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
<span class="go">[class API product obs (&#39;obs2&#39;, &#39;obs1&#39;)]</span>
</pre></div>
</div>
</div>
<div class="section" id="extended-pdf">
<h2>Extended PDF<a class="headerlink" href="#extended-pdf" title="Permalink to this headline">¶</a></h2>
<p>In the event there are different <em>species</em> of distributions in a given observable,
the simple sum of PDFs does not a priori provides the absolute number of events for each specie but rather the fraction as seen above.
An example is a Gaussian mass distribution with an exponential background, e.g.</p>
<p><span class="math notranslate nohighlight">\(P = f_{S}\frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^{2}}{2\sigma^{2}}} + (1 - f_{S}) e^{-\alpha x}\)</span></p>
<p>Since we are interested to express a measurement of the number of events,
the expression <span class="math notranslate nohighlight">\(M(x) = N_{S}S(x) + N_{B}B(x)\)</span> respect that M(x) is normalised to <span class="math notranslate nohighlight">\(N_{S} + N_{B} = N\)</span> instead of one.
This means that <span class="math notranslate nohighlight">\(M(x)\)</span> is not a true PDF but rather an expression for two quantities, the shape and the number of events in the distributions.</p>
<p>An extended PDF can be easily implemented in zfit in two ways:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a parameter for the number of events</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">yieldGauss</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;yieldGauss&quot;</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Extended PDF using a predefined method</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extended_gauss_method</span> <span class="o">=</span> <span class="n">gauss</span><span class="o">.</span><span class="n">create_extended</span><span class="p">(</span><span class="n">yieldGauss</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Or simply with a Python syntax of multiplying a PDF with the parameter</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">extended_gauss_python</span> <span class="o">=</span> <span class="n">yieldGauss</span> <span class="o">*</span> <span class="n">gauss</span>
</pre></div>
</div>
</div>
<div class="section" id="custom-pdf">
<h2>Custom PDF<a class="headerlink" href="#custom-pdf" title="Permalink to this headline">¶</a></h2>
<p>A fundamental design choice of zfit is the ability to create custom PDFs and functions in an easy way.
Let’s consider a simplified implementation</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyGauss</span><span class="p">(</span><span class="n">zfit</span><span class="o">.</span><span class="n">pdf</span><span class="o">.</span><span class="n">ZPDF</span><span class="p">):</span>
<span class="gp">... </span>   <span class="sd">&quot;&quot;&quot;Simple implementation of a Gaussian similar to :py:class`~zfit.pdf.Gauss` class&quot;&quot;&quot;</span>
<span class="gp">... </span>   <span class="n">_N_OBS</span> <span class="o">=</span> <span class="mi">1</span>  <span class="c1"># dimension, can be omitted</span>
<span class="gp">... </span>   <span class="n">_PARAMS</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">,</span> <span class="s1">&#39;std&#39;</span><span class="p">]</span>  <span class="c1"># the name of the parameters</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">_unnormalized_pdf</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>   <span class="n">x</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">ztf</span><span class="o">.</span><span class="n">unstack_x</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">mean</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="gp">... </span>   <span class="n">std</span>  <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="n">zfit</span><span class="o">.</span><span class="n">ztf</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">mean</span><span class="p">)</span><span class="o">/</span><span class="n">std</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>This is the basic information required for this custom PDF.
With this new PDF one can access the same feature of the predefined PDFs, e.g.</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">obs</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="p">(</span><span class="s2">&quot;obs1&quot;</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">mean</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;mean&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">std</span>  <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Parameter</span><span class="p">(</span><span class="s2">&quot;std&quot;</span><span class="p">,</span> <span class="mf">1.</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_gauss</span> <span class="o">=</span> <span class="n">MyGauss</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="s1">&#39;obs1&#39;</span><span class="p">,</span> <span class="n">mean</span><span class="o">=</span><span class="n">mean</span><span class="p">,</span> <span class="n">std</span><span class="o">=</span><span class="n">std</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># For instance integral probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">integral</span> <span class="o">=</span> <span class="n">my_gauss</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">probs</span>    <span class="o">=</span> <span class="n">my_gauss</span><span class="o">.</span><span class="n">pdf</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">norm_range</span><span class="o">=</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
</pre></div>
</div>
<p>Finally, we could also improve the description of the PDF by providing a analytical integral for the <code class="docutils literal notranslate"><span class="pre">MyGauss</span></code> PDF:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">gauss_integral_from_any_to_any</span><span class="p">(</span><span class="n">limits</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">model</span><span class="p">):</span>
<span class="gp">... </span>   <span class="p">(</span><span class="n">lower</span><span class="p">,),</span> <span class="p">(</span><span class="n">upper</span><span class="p">,)</span> <span class="o">=</span> <span class="n">limits</span><span class="o">.</span><span class="n">limits</span>
<span class="gp">... </span>   <span class="n">mean</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
<span class="gp">... </span>   <span class="n">std</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="s1">&#39;std&#39;</span><span class="p">]</span>
<span class="gp">... </span>   <span class="c1"># Write you integral</span>
<span class="gp">... </span>   <span class="k">return</span> <span class="mf">42.</span> <span class="c1"># Dummy value</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Register the integral</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">limits</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="o">.</span><span class="n">from_axes</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="p">(</span><span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="o">.</span><span class="n">ANY_LOWER</span><span class="p">,</span> <span class="n">zfit</span><span class="o">.</span><span class="n">Space</span><span class="o">.</span><span class="n">ANY_UPPER</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">MyGauss</span><span class="o">.</span><span class="n">register_analytic_integral</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">gauss_integral_from_any_to_any</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="sampling-from-a-model">
<h3>Sampling from a Model<a class="headerlink" href="#sampling-from-a-model" title="Permalink to this headline">¶</a></h3>
<p>In order to sample from model, there are two different methods,
<a class="reference internal" href="../api/zfit.core.basemodel.html#zfit.core.basemodel.BaseModel.sample" title="zfit.core.basemodel.BaseModel.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> for <strong>advanced</strong> sampling returning a Tensor, and
<a class="reference internal" href="../api/zfit.core.basemodel.html#zfit.core.basemodel.BaseModel.create_sampler" title="zfit.core.basemodel.BaseModel.create_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_sampler()</span></code></a> for <strong>multiple sampling</strong> as used for toys.</p>
</div>
<div class="section" id="tensor-sampling">
<h3>Tensor sampling<a class="headerlink" href="#tensor-sampling" title="Permalink to this headline">¶</a></h3>
<p>The sample from <a class="reference internal" href="../api/zfit.core.basemodel.html#zfit.core.basemodel.BaseModel.sample" title="zfit.core.basemodel.BaseModel.sample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sample()</span></code></a> is a Tensor that samples when executed.
This is for an advanced usecase only</p>
</div>
<div class="section" id="playing-with-toys-multiple-samplings">
<h3>Playing with toys: Multiple samplings<a class="headerlink" href="#playing-with-toys-multiple-samplings" title="Permalink to this headline">¶</a></h3>
<p>The method <a class="reference internal" href="../api/zfit.core.basemodel.html#zfit.core.basemodel.BaseModel.create_sampler" title="zfit.core.basemodel.BaseModel.create_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_sampler()</span></code></a> returns a sampler that can be used
like a <code class="xref py py-class docutils literal notranslate"><span class="pre">Data</span></code> object (e.g. for building a <a class="reference internal" href="../api/zfit.core.interfaces.html#zfit.core.interfaces.ZfitLoss" title="zfit.core.interfaces.ZfitLoss"><code class="xref py py-class docutils literal notranslate"><span class="pre">ZfitLoss</span></code></a>).
The sampling itself is <em>not yet done</em> but only when <a class="reference internal" href="../api/zfit.core.data.html#zfit.core.data.Sampler.resample" title="zfit.core.data.Sampler.resample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">resample()</span></code></a> is
invoked. The sample generated depends on the original pdf at this point, e.g. parameters have the
value they have when the <a class="reference internal" href="../api/zfit.core.data.html#zfit.core.data.Sampler.resample" title="zfit.core.data.Sampler.resample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">resample()</span></code></a> is invoked. To have certain
parameters fixed, they have to be specified <em>either</em> on <a class="reference internal" href="../api/zfit.core.basemodel.html#zfit.core.basemodel.BaseModel.create_sampler" title="zfit.core.basemodel.BaseModel.create_sampler"><code class="xref py py-meth docutils literal notranslate"><span class="pre">create_sampler()</span></code></a>
via <cite>fixed_params</cite>, on <a class="reference internal" href="../api/zfit.core.data.html#zfit.core.data.Sampler.resample" title="zfit.core.data.Sampler.resample"><code class="xref py py-meth docutils literal notranslate"><span class="pre">resample()</span></code></a> by specifying which parameter
will take which value via <cite>param_values</cite> or by changing the attribute of <a class="reference internal" href="../api/zfit.core.data.html#zfit.core.data.Sampler" title="zfit.core.data.Sampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">Sampler</span></code></a>.</p>
<p>How typically toys look like:
.. _playing_with_toys:</p>
<p>A typical example of toys would therefore look like</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a model depending on mu, sigma</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_sampler</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">fixed_params</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sampler</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">minimizer</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">minimize</span><span class="o">.</span><span class="n">Minuit</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">run_number</span> <span class="ow">in</span> <span class="n">n_runs</span><span class="p">:</span>
<span class="gp">... </span>   <span class="c1"># initialize the parameters randomly</span>
<span class="gp">... </span>   <span class="n">sampler</span><span class="o">.</span><span class="n">resample</span><span class="p">()</span>  <span class="c1"># now the resampling gets executed</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="n">mu</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span>
<span class="gp">... </span>   <span class="n">sigma</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">()))</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="n">result</span> <span class="o">=</span> <span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">nll</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="c1"># safe the result, collect the values, calculate errors...</span>
</pre></div>
</div>
<p>Here we fixed all parameters as they have been initialized and then sample. If we do not provide any
arguments to <cite>resample</cite>, this will always sample now from the distribution with the parameters set to the</p>
<blockquote>
<div><p>values when the sampler was created.</p>
</div></blockquote>
<p>To give another, though not very useful example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># create a model depending on mu1, sigma1, mu2, sigma2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_sampler</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">fixed_params</span><span class="o">=</span><span class="p">[</span><span class="n">mu1</span><span class="p">,</span> <span class="n">mu2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sampler</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span><span class="o">.</span><span class="n">resample</span><span class="p">()</span>  <span class="c1"># now it sampled</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># do something with nll</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">nll</span><span class="p">)</span>  <span class="c1"># minimize</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span><span class="o">.</span><span class="n">resample</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># note that the nll, being dependent on `sampler`, also changed!</span>
</pre></div>
</div>
<p>The sample is now resampled with the <em>current values</em> (minimized values) of <cite>sigma1</cite>, <cite>sigma2</cite> and with
the initial values of <cite>mu1</cite>, <cite>mu2</cite> (because they have been fixed).</p>
<p>We can also specify the parameter values explicitly by
using the following argument. Reusing the example above</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">sigma</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">param_values</span><span class="o">=</span><span class="p">{</span><span class="n">sigma1</span><span class="p">:</span> <span class="mi">5</span><span class="p">})</span>
</pre></div>
</div>
<p>The sample (and therefore also the sample the <cite>nll</cite> depends on) is now sampled with <cite>sigma1</cite> set to 5.</p>
<p>If some parameters are constrained from external measurements, usually Gaussian constraints, then sampling of
those parameters might be needed to obtain an unbiased sample from the model. Example:</p>
<div class="highlight-pycon notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># same model depending on mu1, sigma1, mu2, sigma2</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">constraint</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">constraint</span><span class="o">.</span><span class="n">GaussianConstraint</span><span class="p">(</span><span class="n">params</span><span class="o">=</span><span class="p">[</span><span class="n">sigma1</span><span class="p">,</span> <span class="n">sigma2</span><span class="p">],</span> <span class="n">mu</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">sigma</span><span class="o">=</span><span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">])</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">n_samples</span> <span class="o">=</span> <span class="mi">1000</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">sampler</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">create_sampler</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">fixed_params</span><span class="o">=</span><span class="p">[</span><span class="n">mu1</span><span class="p">,</span> <span class="n">mu2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nll</span> <span class="o">=</span> <span class="n">zfit</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">UnbinnedNLL</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">model</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">sampler</span><span class="p">,</span> <span class="n">constraints</span><span class="o">=</span><span class="n">constraint</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">constr_values</span> <span class="o">=</span> <span class="n">constraint</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">n</span><span class="o">=</span><span class="n">n_samples</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_samples</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">sampler</span><span class="o">.</span><span class="n">resample</span><span class="p">(</span><span class="n">param_values</span><span class="o">=</span><span class="p">{</span><span class="n">sigma1</span><span class="p">:</span> <span class="n">constr_values</span><span class="p">[</span><span class="n">sigma1</span><span class="p">][</span><span class="n">i</span><span class="p">],</span>
<span class="gp">&gt;&gt;&gt; </span>                                   <span class="n">sigma2</span><span class="p">:</span> <span class="n">constr_values</span><span class="p">[</span><span class="n">sigma2</span><span class="p">][</span><span class="n">i</span><span class="p">]})</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="c1"># do something with nll</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">minimizer</span><span class="o">.</span><span class="n">minimize</span><span class="p">(</span><span class="n">nll</span><span class="p">)</span>  <span class="c1"># minimize</span>
</pre></div>
</div>
</div>
</div>
</div>


    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
<div id="sourcelink">
  <a href="../_sources/intro/model.rst.txt"
     rel="nofollow">Source</a>
</div>
      
    </p>
    <p>
        &copy; Copyright Copyright 2018, zfit.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>