<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="utf-8" />
    <title>zfit.core.limits &#8212; zfit 0.4.2.dev14+ge966ed3 documentation</title>
    <link rel="stylesheet" href="../../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/language_data.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-2.3.2/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-fixed-top">
    <div class="navbar-inner">
      <div class="container">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>

        <a class="brand" href="../../../index.html">
          zfit</a>
        <span class="navbar-text pull-left"><b>0.4.2.dev14</b></span>

        <div class="nav-collapse">
          <ul class="nav">
            <li class="divider-vertical"></li>
            
                <li><a href="../../../getting_started.html">Getting started</a></li>
                <li><a href="../../../introduction.html">Intro</a></li>
                <li><a href="../../../project.html">Project</a></li>
                <li><a href="../../../API.html">API</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../../index.html">Overview <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../../getting_started.html">Getting started with zfit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../getting_started.html#what-did-just-happen">What did just happen?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">zfit introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/space.html">Space, Observable and Range</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/space.html#definitions">Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/space.html#limits">Limits</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../intro/space.html#defining-limits">Defining limits</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/parameter.html">Parameter</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/parameter.html#independent-parameter">Independent Parameter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/parameter.html#dependent-parameter">Dependent Parameter</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/model.html">Building a model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/model.html#predefined-pdfs-and-basic-properties">Predefined PDFs and basic properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/model.html#composite-pdf">Composite PDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/model.html#extended-pdf">Extended PDF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/model.html#custom-pdf">Custom PDF</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../intro/model.html#sampling-from-a-model">Sampling from a Model</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../intro/model.html#tensor-sampling">Tensor sampling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../intro/model.html#playing-with-toys-multiple-samplings">Playing with toys: Multiple samplings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/data.html">Data</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/data.html#import-dataset-from-a-root-file">Import dataset from a ROOT file</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/data.html#import-dataset-from-a-pandas-dataframe-or-numpy-ndarray">Import dataset from a pandas DataFrame or Numpy ndarray</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/loss.html">Loss</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/loss.html#adding-constraints">Adding constraints</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/loss.html#simultaneous-fits">Simultaneous fits</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../intro/minimize.html">Minimization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../intro/minimize.html#baseline-minimizers">Baseline minimizers</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../project.html">zfit Project</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../project/installation.html">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../project/installation.html#stable-release">Stable release</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/installation.html#from-sources">From sources</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/contributing.html">Contributing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../project/contributing.html#get-started">Get Started!</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/contributing.html#pull-request-guidelines">Pull Request Guidelines</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/upgrade_guide.html">Upgrade guide</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../project/upgrade_guide.html#upgrade-from-zfit-0-3-x-to-0-4-0">Upgrade from zfit 0.3.x to 0.4.0</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/upgrade_guide.html#dependents">Dependents</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/changelog.html">Changelog</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#develop">Develop</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#major-features-and-improvements">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#behavioral-changes">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#bug-fixes-and-small-changes">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#requirement-changes">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#thanks">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id1">0.4.1 (12.1.20)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id2">Major Features and Improvements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id3">0.4.0 (7.1.2020)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id4">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id5">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id6">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id7">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id8">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id9">0.3.7 (6.12.19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id10">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id11">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id12">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id13">Requirement changes</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id14">0.3.6 (12.10.19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id15">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id16">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id17">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id18">Requirement changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id19">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id20">0.3.4 (30-07-19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id21">Major Features and Improvements</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id22">Behavioral changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id23">Bug fixes and small changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#id24">Thanks</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id25">0.3.3 (15-05-19)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id26">0.3.2 (01-05-19)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#breaking-changes">Breaking changes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#bugfixes">Bugfixes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../project/changelog.html#improvements">Improvements</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id27">0.3.1 (30-04-19)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id28">0.3.0 (2019-03-20)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../project/changelog.html#id29">0.0.1 (2018-03-22)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/authors.html">Development Lead</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/authors.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../project/authors.html#contributors">Contributors</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../API.html">zfit API documentation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.html">zfit package</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/zfit.html#subpackages">Subpackages</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.core.html">core</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/zfit.core.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.basefunc.html">basefunc</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.basemodel.html">basemodel</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.baseobject.html">baseobject</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.basepdf.html">basepdf</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/zfit.core.basepdf.html#defining-your-own-pdf">Defining your own pdf</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.constraint.html">constraint</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.data.html">data</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.dependents.html">dependents</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.dimension.html">dimension</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.integration.html">integration</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.interfaces.html">interfaces</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.limits.html">limits</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.loss.html">loss</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.operations.html">operations</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.parameter.html">parameter</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.sample.html">sample</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.core.testing.html">testing</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.minimizers.html">minimizers</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/zfit.minimizers.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.base_tf.html">base_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.baseminimizer.html">baseminimizer</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.fitresult.html">fitresult</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.interface.html">interface</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.minimizer_minuit.html">minimizer_minuit</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.minimizer_tfp.html">minimizer_tfp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.minimizers_scipy.html">minimizers_scipy</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.optimizers_tf.html">optimizers_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.minimizers.tf_external_optimizer.html">tf_external_optimizer</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.models.html">models</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/zfit.models.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.basefunctor.html">basefunctor</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.basic.html">basic</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.dist_tfp.html">dist_tfp</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.functions.html">functions</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.functor.html">functor</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.physics.html">physics</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.polynomials.html">polynomials</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.models.special.html">special</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.util.html">util</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/zfit.util.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.cache.html">cache</a><ul>
<li class="toctree-l7"><a class="reference internal" href="../../../api/zfit.util.cache.html#basic-principle">Basic principle</a></li>
</ul>
</li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.checks.html">checks</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.container.html">container</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.diverse.html">diverse</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.exception.html">exception</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.execution.html">execution</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.graph.html">graph</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.logging.html">logging</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.temporary.html">temporary</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.util.ztyping.html">ztyping</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.html">z</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../../api/zfit.z.html#submodules">Submodules</a><ul>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.const.html">const</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.math.html">math</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.random.html">random</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.tools.html">tools</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.wrapping_tf.html">wrapping_tf</a></li>
<li class="toctree-l6"><a class="reference internal" href="../../../api/zfit.z.zextension.html">zextension</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../api/zfit.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.constraint.html">constraint</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.data.html">data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.func.html">func</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.loss.html">loss</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.minimize.html">minimize</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.param.html">param</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.pdf.html">pdf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.sample.html">sample</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.settings.html">settings</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.pdf.html">pdf</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.func.html">func</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.data.html">data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.loss.html">loss</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.constraint.html">constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.minimize.html">minimize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.minimizers.fitresult.html">fitresult</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.settings.html">settings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../api/zfit.z.html">z</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../api/zfit.z.html#submodules">Submodules</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.const.html">const</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.math.html">math</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.random.html">random</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.tools.html">tools</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.wrapping_tf.html">wrapping_tf</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../api/zfit.z.zextension.html">zextension</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</ul>
</li>
              
                <li class="dropdown">
  <a role="button"
     id="dLabelLocalToc"
     data-toggle="dropdown"
     data-target="#"
     href="#">Page <b class="caret"></b></a>
  <ul class="dropdown-menu localtoc"
      role="menu"
      aria-labelledby="dLabelLocalToc"></ul>
</li>
              
            
            
            
            
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
      </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body span12 content" role="main">
      
  <h1>Source code for zfit.core.limits</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">.. include:: ../../docs/subst_types.rst</span>

<span class="sd"># NamedSpace and limits</span>

<span class="sd">Limits define a certain interval in a specific dimension. This can be used to define, for example,</span>
<span class="sd">the limits of an integral over several dimensions or a normalization range.</span>



<span class="sd">### with limits</span>

<span class="sd">Therefore a different way of specifying limits is possible, basically by defining chunks of the</span>
<span class="sd">lower and the upper limits. The shape of a lower resp. upper limit is (n_limits, n_obs).</span>

<span class="sd">Example: 1-dim: 1 to 4, 2.-dim: 21 to 24 AND 1.-dim: 6 to 7, 2.-dim 26 to 27</span>
<span class="sd">&gt;&gt;&gt; lower = ((1, 21), (6, 26))</span>
<span class="sd">&gt;&gt;&gt; upper = ((4, 24), (7, 27))</span>
<span class="sd">&gt;&gt;&gt; limits2 = Space(limits=(lower, upper), obs=(&#39;obs1&#39;, &#39;obs2&#39;)</span>

<span class="sd">General form:</span>

<span class="sd">lower = ((lower1_dim1, lower1_dim2, lower1_dim3), (lower2_dim1, lower2_dim2, lower2_dim3),...)</span>
<span class="sd">upper = ((upper1_dim1, upper1_dim2, upper1_dim3), (upper2_dim1, upper2_dim2, upper2_dim3),...)</span>

<span class="sd">## Using :py:class:`~zfit.Space`</span>

<span class="sd">:py:class:`NamedSpace` offers a few useful functions to easier deal with the intervals</span>

<span class="sd">### Handling areas</span>

<span class="sd">For example when doing a MC integration using the expectation value, it is mandatory to know</span>
<span class="sd">the total area of your intervals. You can retrieve the total area or (if multiple limits (=intervals</span>
<span class="sd"> are given) the area of each interval.</span>

<span class="sd"> &gt;&gt;&gt; area = limits2.area()</span>
<span class="sd"> &gt;&gt;&gt; area_1, area_2 = limits2.iter_areas(rel=False)  # if rel is True, return the fraction of 1</span>


<span class="sd">### Retrieve the limits</span>

<span class="sd">&gt;&gt;&gt; lower, upper = limits2.limits</span>

<span class="sd">which you can now iterate through. For example, to calc an integral (assuming there is a function</span>
<span class="sd">`integrate` taking the lower and upper limits and returning the function), you can do</span>
<span class="sd">&gt;&gt;&gt; def integrate(lower_limit, upper_limit): return 42  # dummy function</span>
<span class="sd">&gt;&gt;&gt; integral = sum(integrate(lower_limit=low, upper_limit=up) for low, up in zip(lower, upper))</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="c1">#  Copyright (c) 2020 zfit</span>

<span class="c1"># TODO(Mayou36): update docs above</span>

<span class="kn">import</span> <span class="nn">functools</span>
<span class="kn">import</span> <span class="nn">inspect</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">OrderedDict</span>
<span class="kn">from</span> <span class="nn">contextlib</span> <span class="kn">import</span> <span class="n">suppress</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Union</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>

<span class="kn">from</span> <span class="nn">.baseobject</span> <span class="kn">import</span> <span class="n">BaseObject</span>
<span class="kn">from</span> <span class="nn">.dimension</span> <span class="kn">import</span> <span class="n">add_spaces</span><span class="p">,</span> <span class="n">combine_spaces</span>
<span class="kn">from</span> <span class="nn">.interfaces</span> <span class="kn">import</span> <span class="n">ZfitSpace</span>
<span class="kn">from</span> <span class="nn">..util</span> <span class="kn">import</span> <span class="n">ztyping</span>
<span class="kn">from</span> <span class="nn">..util.checks</span> <span class="kn">import</span> <span class="n">NOT_SPECIFIED</span>
<span class="kn">from</span> <span class="nn">..util.container</span> <span class="kn">import</span> <span class="n">convert_to_container</span>
<span class="kn">from</span> <span class="nn">..util.exception</span> <span class="kn">import</span> <span class="p">(</span><span class="n">AxesNotSpecifiedError</span><span class="p">,</span> <span class="n">IntentionNotUnambiguousError</span><span class="p">,</span> <span class="n">LimitsUnderdefinedError</span><span class="p">,</span>
                              <span class="n">MultipleLimitsNotImplementedError</span><span class="p">,</span> <span class="n">NormRangeNotImplementedError</span><span class="p">,</span> <span class="n">ObsNotSpecifiedError</span><span class="p">,</span>
                              <span class="n">OverdefinedError</span><span class="p">,</span> <span class="n">LimitsNotSpecifiedError</span><span class="p">,</span> <span class="p">)</span>
<span class="kn">from</span> <span class="nn">..util.temporary</span> <span class="kn">import</span> <span class="n">TemporarilySet</span>


<span class="c1"># Singleton</span>
<div class="viewcode-block" id="Any"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Any">[docs]</a><span class="k">class</span> <span class="nc">Any</span><span class="p">:</span>
    <span class="n">_singleton_instance</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">instance</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_singleton_instance</span>
        <span class="k">if</span> <span class="n">instance</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">instance</span> <span class="o">=</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__new__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_singleton_instance</span> <span class="o">=</span> <span class="n">instance</span>

        <span class="k">return</span> <span class="n">instance</span>

    <span class="k">def</span> <span class="nf">__init_subclass__</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">__init_subclass__</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">cls</span><span class="o">.</span><span class="n">_singleton_instance</span> <span class="o">=</span> <span class="kc">None</span>  <span class="c1"># each subclass is a singleton of &quot;itself&quot;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Any&gt;&#39;</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="c1"># def __eq__(self, other):</span>
    <span class="c1">#     return True</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span></div>

    <span class="c1"># def __hash__(self):</span>
    <span class="c1">#     return</span>


<div class="viewcode-block" id="AnyLower"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.AnyLower">[docs]</a><span class="k">class</span> <span class="nc">AnyLower</span><span class="p">(</span><span class="n">Any</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Any Lower Limit&gt;&#39;</span>

    <span class="c1"># def __eq__(self, other):</span>
    <span class="c1">#     return False</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__gt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<div class="viewcode-block" id="AnyUpper"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.AnyUpper">[docs]</a><span class="k">class</span> <span class="nc">AnyUpper</span><span class="p">(</span><span class="n">Any</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="s1">&#39;&lt;Any Upper Limit&gt;&#39;</span>

    <span class="c1"># def __eq__(self, other):</span>
    <span class="c1">#     return False</span>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="fm">__lt__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">False</span></div>


<span class="n">ANY</span> <span class="o">=</span> <span class="n">Any</span><span class="p">()</span>
<span class="n">ANY_LOWER</span> <span class="o">=</span> <span class="n">AnyLower</span><span class="p">()</span>
<span class="n">ANY_UPPER</span> <span class="o">=</span> <span class="n">AnyUpper</span><span class="p">()</span>


<div class="viewcode-block" id="Space"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space">[docs]</a><span class="k">class</span> <span class="nc">Space</span><span class="p">(</span><span class="n">ZfitSpace</span><span class="p">,</span> <span class="n">BaseObject</span><span class="p">):</span>
    <span class="n">AUTO_FILL</span> <span class="o">=</span> <span class="nb">object</span><span class="p">()</span>
    <span class="n">ANY</span> <span class="o">=</span> <span class="n">ANY</span>
    <span class="n">ANY_LOWER</span> <span class="o">=</span> <span class="n">ANY_LOWER</span>  <span class="c1"># TODO: needed? or move everything inside?</span>
    <span class="n">ANY_UPPER</span> <span class="o">=</span> <span class="n">ANY_UPPER</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span><span class="p">,</span> <span class="n">limits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Space&quot;</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Define a space with the name (`obs`) of the axes (and it&#39;s number) and possibly it&#39;s limits.</span>

<span class="sd">        Args:</span>
<span class="sd">            obs (str, List[str,...]):</span>
<span class="sd">            limits ():</span>
<span class="sd">            name (str):</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Space_&quot;</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_obs</span> <span class="o">=</span> <span class="n">obs</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_set_limits</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_any</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">limits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_space</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">from_axes</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_space</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
            <span class="n">new_space</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">axes</span>

        <span class="k">return</span> <span class="n">new_space</span>

<div class="viewcode-block" id="Space.from_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.from_axes">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_axes</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span><span class="p">,</span>
                  <span class="n">limits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                  <span class="n">name</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a space from `axes` instead of from `obs`.</span>

<span class="sd">        Args:</span>
<span class="sd">            axes ():</span>
<span class="sd">            limits ():</span>
<span class="sd">            name (str):</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AxesNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Axes cannot be `None`&quot;</span><span class="p">)</span>
        <span class="n">fake_obs</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span> <span class="k">for</span> <span class="n">axis</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">)</span>  <span class="c1"># in order to create an instance</span>

        <span class="n">new_space</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">fake_obs</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_obs</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">new_space</span><span class="o">.</span><span class="n">_check_convert_input_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_convert_obs_to_str</span><span class="p">(</span><span class="n">obs</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">obs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obs</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_convert_axes_to_int</span><span class="p">(</span><span class="n">axes</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">axes</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">axes</span>

    <span class="k">def</span> <span class="nf">_check_set_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">limits</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_lower_upper</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_limits</span> <span class="o">=</span> <span class="n">limits</span>

    <span class="k">def</span> <span class="nf">_check_convert_input_lower_upper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">):</span>

        <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_limit</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">lower</span><span class="p">)</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_limit</span><span class="p">(</span><span class="n">limit</span><span class="o">=</span><span class="n">upper</span><span class="p">)</span>
        <span class="n">lower_is_iterable</span> <span class="o">=</span> <span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span>
        <span class="n">upper_is_iterable</span> <span class="o">=</span> <span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">upper</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lower_is_iterable</span> <span class="ow">or</span> <span class="n">upper_is_iterable</span><span class="p">)</span> <span class="ow">and</span> <span class="n">lower</span> <span class="ow">is</span> <span class="ow">not</span> <span class="n">upper</span><span class="p">:</span>
            <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lower and upper limits wrong:&quot;</span>
                       <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">lower = </span><span class="si">{lower}</span><span class="s2">&quot;</span>
                       <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">upper = </span><span class="si">{upper}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">lower_is_iterable</span> <span class="o">^</span> <span class="n">upper_is_iterable</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lower and upper limits wrong:&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">lower = </span><span class="si">{l}</span><span class="s2">&quot;</span>
                             <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">upper = </span><span class="si">{u}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">l</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">u</span><span class="o">=</span><span class="n">upper</span><span class="p">))</span>
        <span class="k">if</span> <span class="n">lower_is_iterable</span> <span class="ow">and</span> <span class="n">upper_is_iterable</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">shape_np_tf</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span> <span class="o">==</span> <span class="n">shape_np_tf</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span>
                <span class="nb">len</span><span class="p">(</span><span class="n">shape_np_tf</span><span class="p">(</span><span class="n">lower</span><span class="p">))</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)):</span>  <span class="c1"># 3 for EventSpace eager</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Lower and/or upper limits invalid:&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">lower: </span><span class="si">{lower}</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">upper: </span><span class="si">{upper}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">))</span>

            <span class="k">if</span> <span class="ow">not</span> <span class="n">shape_np_tf</span><span class="p">(</span><span class="n">lower</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Limits shape not compatible with number of obs/axes&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">lower: </span><span class="si">{lower}</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">upper: </span><span class="si">{upper}</span><span class="s2">&quot;</span>
                                 <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">n_obs: </span><span class="si">{n_obs}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">lower</span><span class="o">=</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="o">=</span><span class="n">upper</span><span class="p">,</span> <span class="n">n_obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>

    <span class="k">def</span> <span class="nf">_check_convert_input_limit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limit</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LowerTypeInput</span><span class="p">,</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">UpperTypeInput</span><span class="p">],</span>
                                   <span class="n">replace</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LowerTypeReturn</span><span class="p">,</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">UpperTypeReturn</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Check and sanitize the lower or upper limit.</span>

<span class="sd">        Args:</span>
<span class="sd">            limit ():</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">replace</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">replace</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">replace</span>
        <span class="k">if</span> <span class="n">limit</span> <span class="ow">is</span> <span class="n">NOT_SPECIFIED</span> <span class="ow">or</span> <span class="n">limit</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">)</span> <span class="ow">and</span> <span class="n">limit</span> <span class="o">==</span> <span class="p">())</span> <span class="ow">or</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">limit</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="ow">and</span> <span class="n">limit</span><span class="o">.</span><span class="n">size</span> <span class="o">==</span> <span class="mi">0</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Currently, () is not supported as limits. Should this be default for None?&quot;</span><span class="p">)</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">shape_np_tf</span><span class="p">(</span><span class="n">limit</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="p">((</span><span class="n">limit</span><span class="p">,),)</span>

        <span class="n">shape</span> <span class="o">=</span> <span class="n">shape_np_tf</span><span class="p">(</span><span class="n">limit</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="p">():</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Shape of limit </span><span class="si">{}</span><span class="s2"> wrong.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">limit</span><span class="p">))</span>

        <span class="c1"># replace</span>
        <span class="k">if</span> <span class="n">replace</span><span class="p">:</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">replace</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">lim</span><span class="p">)</span> <span class="k">for</span> <span class="n">lim</span> <span class="ow">in</span> <span class="n">limit</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">limit</span>

    <span class="k">def</span> <span class="nf">_check_set_lower_upper</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">lower</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LowerTypeInput</span><span class="p">,</span> <span class="n">upper</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">UpperTypeInput</span><span class="p">):</span>

        <span class="k">if</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">lower</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_limit</span><span class="p">(</span><span class="n">lower</span><span class="p">)</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_limit</span><span class="p">(</span><span class="n">upper</span><span class="p">)</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_check_set_limits</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_check_convert_input_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span><span class="p">,</span>
                                  <span class="n">allow_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeReturn</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allow_none</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AxesNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;TODO: Cannot be None&quot;</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>  <span class="c1"># TODO(Mayou36): extend like _check_obs?</span>
        <span class="k">return</span> <span class="n">axes</span>

    <span class="k">def</span> <span class="nf">_check_convert_input_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span><span class="p">,</span>
                                 <span class="n">allow_none</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Input check: Convert `NOT_SPECIFIED` to None or check if obs are all strings.</span>

<span class="sd">        Args:</span>
<span class="sd">            obs (str, List[str], None, NOT_SPECIFIED):</span>

<span class="sd">        Returns:</span>
<span class="sd">            type:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">allow_none</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">ObsNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;TODO: Cannot be None&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">obs</span><span class="o">.</span><span class="n">obs</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
            <span class="n">obs_not_str</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span> <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">obs_not_str</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The following observables are not strings: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">obs_not_str</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">obs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the limits.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_limits</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limit1d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Simplified limits getter for 1 obs, 1 limit only: return the tuple(lower, upper).</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple(float, float): so :code:`lower, upper = space.limit1d` for a simple, 1 obs limit.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if the conditions (n_obs or n_limits) are not satisfied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot call `limit1d, as `Space` has more than one observables: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_limits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot call `limit1d, as `Space` has several limits: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_limits</span><span class="p">))</span>

        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">lower</span><span class="p">,),</span> <span class="p">(</span><span class="n">upper</span><span class="p">,)</span> <span class="o">=</span> <span class="n">limits</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">limit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limit2d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Simplified `limits` for exactly 2 obs, 1 limit: return the tuple(low_obs1, low_obs2, up_obs1, up_obs2).</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple(float, float, float, float): so `low_x, low_y, up_x, up_y = space.limit2d` for a single, 2 obs limit.</span>
<span class="sd">                low_x is the lower limit in x, up_x is the upper limit in x etc.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if the conditions (n_obs or n_limits) are not satisfied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot call `limit2d, as `Space` has not two observables: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_limits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot call `limit2d, as `Space` has several limits: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_limits</span><span class="p">))</span>

        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="p">(</span><span class="n">lower</span><span class="p">,),</span> <span class="p">(</span><span class="n">upper</span><span class="p">,)</span> <span class="o">=</span> <span class="n">limits</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="o">*</span><span class="n">lower</span><span class="p">,</span> <span class="o">*</span><span class="n">upper</span>
        <span class="k">return</span> <span class="n">limit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">limits1d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Simplified `.limits` for exactly 1 obs, n limits: return the tuple(low_1, ..., low_n, up_1, ..., up_n).</span>

<span class="sd">        Returns:</span>
<span class="sd">            tuple(float, float, ...): so `low_1, low_2, up_1, up_2 = space.limits1d` for several, 1 obs limits.</span>
<span class="sd">                low_1 to up_1 is the first interval, low_2 to up_2 is the second interval etc.</span>

<span class="sd">        Raises:</span>
<span class="sd">            RuntimeError: if the conditions (n_obs or n_limits) are not satisfied.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Cannot call `limits1d, as `Space` has more than one observable: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
        <span class="c1"># if self.n_limits &gt; 1:</span>
        <span class="c1">#     raise RuntimeError(&quot;Cannot call `limit1d, as `Space` has several limits: {}&quot;.format(self.n_limits))</span>

        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">in</span> <span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_lower</span><span class="p">,</span> <span class="n">new_upper</span> <span class="o">=</span> <span class="p">[],</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_limits</span><span class="p">(</span><span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="n">new_lower</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="n">new_upper</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">new_lower</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_lower</span><span class="p">)</span>
            <span class="n">new_upper</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_upper</span><span class="p">)</span>
            <span class="n">limit</span> <span class="o">=</span> <span class="o">*</span><span class="n">new_lower</span><span class="p">,</span> <span class="o">*</span><span class="n">new_upper</span>
        <span class="k">return</span> <span class="n">limit</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">lower</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LowerTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the lower limits.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">limits</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">upper</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">UpperTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the upper limits.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>  <span class="c1"># TODO(naming): better name? Like rank?</span>
        <span class="sd">&quot;&quot;&quot;Return the number of observables/axes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int &gt;= 1</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">length</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">n_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The number of different limits.</span>

<span class="sd">        Returns:</span>
<span class="sd">            int &gt;= 1</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">return</span> <span class="mi">0</span>
        <span class="k">return</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">obs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The observables (&quot;axes with str&quot;)the space is defined in.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_obs</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">axes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;The axes (&quot;obs with int&quot;) the space is defined in.</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span>

<div class="viewcode-block" id="Space.get_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.get_axes">[docs]</a>    <span class="k">def</span> <span class="nf">get_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">as_dict</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                 <span class="n">autofill</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeReturn</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Return the axes corresponding to the `obs` (or all if None).</span>

<span class="sd">        Args:</span>
<span class="sd">            obs ():</span>
<span class="sd">            as_dict (bool): If True, returns a ordered dictionary with {obs: axis}</span>
<span class="sd">            autofill (bool): If True and the axes are not specified, automatically fill</span>
<span class="sd">                them with the default numbering and return (not setting them).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple, OrderedDict</span>

<span class="sd">        Raises:</span>
<span class="sd">            ValueError: if the requested `obs` do not match with the one defined in the range</span>
<span class="sd">            AxesNotSpecifiedError: If the axes in this :py:class:`~zfit.Space` have not been specified.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># check input</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_obs</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">autofill</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AxesNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;The axes have not been specified&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">o</span><span class="p">)]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="n">missing_obs</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The requested observables </span><span class="si">{mis}</span><span class="s2"> are not contained in the defined &quot;</span>
                                 <span class="s2">&quot;observables </span><span class="si">{obs}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mis</span><span class="o">=</span><span class="n">missing_obs</span><span class="p">,</span> <span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span>
        <span class="k">if</span> <span class="n">as_dict</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">axes</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">axes</span></div>

<div class="viewcode-block" id="Space.iter_limits"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.iter_limits">[docs]</a>    <span class="k">def</span> <span class="nf">iter_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">as_tuple</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">_IterLimitsTypeReturn</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the limits, either as :py:class:`~zfit.Space` objects or as pure limits-tuple.</span>

<span class="sd">        This makes iterating over limits easier: `for limit in space.iter_limits()`</span>
<span class="sd">        allows to, for example, pass `limit` to a function that can deal with simple limits</span>
<span class="sd">        only or if `as_tuple` is True the `limit` can be directly used to calculate something.</span>

<span class="sd">        Example:</span>
<span class="sd">            .. code:: python</span>

<span class="sd">                for lower, upper in space.iter_limits(as_tuple=True):</span>
<span class="sd">                    integrals = integrate(lower, upper)  # calculate integral</span>
<span class="sd">                integral = sum(integrals)</span>


<span class="sd">        Returns:</span>
<span class="sd">            List[:py:class:`~zfit.Space`] or List[limit,...]:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LimitsNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Space does not have limits, cannot iterate over them.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">as_tuple</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">space_objects</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_limits</span><span class="p">(</span><span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
                    <span class="n">lower</span> <span class="o">=</span> <span class="p">(</span><span class="n">lower</span><span class="p">,)</span>
                    <span class="n">upper</span> <span class="o">=</span> <span class="p">(</span><span class="n">upper</span><span class="p">,)</span>
                    <span class="n">limit</span> <span class="o">=</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">limit</span> <span class="o">=</span> <span class="n">lower</span>
                <span class="n">space</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limit</span><span class="p">)</span>
                <span class="n">space_objects</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">space</span><span class="p">)</span>
            <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">space_objects</span><span class="p">)</span></div>

<div class="viewcode-block" id="Space.with_limits"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.with_limits">[docs]</a>    <span class="k">def</span> <span class="nf">with_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">limits</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a copy of the space with the new `limits` (and the new `name`).</span>

<span class="sd">        Args:</span>
<span class="sd">            limits ():</span>
<span class="sd">            name (str):</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.with_obs"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.with_obs">[docs]</a>    <span class="k">def</span> <span class="nf">with_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sort by `obs` and return the new instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            obs ():</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">obs</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_obs_to_str</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">new_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reorder_indices</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reorder_by_indices</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">new_indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.with_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.with_axes">[docs]</a>    <span class="k">def</span> <span class="nf">with_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Sort by `obs` and return the new instance.</span>

<span class="sd">        Args:</span>
<span class="sd">            axes ():</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: what if self.axes is None? Just add them?</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">axes</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_convert_axes_to_int</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">new_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_reorder_indices</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">reorder_by_indices</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">new_indices</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.get_reorder_indices"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.get_reorder_indices">[docs]</a>    <span class="k">def</span> <span class="nf">get_reorder_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                            <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Indices that would order `self.obs` as `obs` respectively `self.axes` as `axes`.</span>

<span class="sd">        Args:</span>
<span class="sd">            obs ():</span>
<span class="sd">            axes ():</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obs_none</span> <span class="o">=</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">axes_none</span> <span class="o">=</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span>

        <span class="n">obs_is_defined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">obs_none</span>
        <span class="n">axes_is_defined</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">axes_none</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">obs_is_defined</span> <span class="ow">or</span> <span class="n">axes_is_defined</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Neither the `obs` nor `axes` are defined.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obs_is_defined</span><span class="p">:</span>
            <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="p">[</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">old</span><span class="p">,</span> <span class="n">new</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">axes</span> <span class="k">if</span> <span class="n">a</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">]</span>

        <span class="n">new_indices</span> <span class="o">=</span> <span class="n">_reorder_indices</span><span class="p">(</span><span class="n">old</span><span class="o">=</span><span class="n">old</span><span class="p">,</span> <span class="n">new</span><span class="o">=</span><span class="n">new</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_indices</span></div>

<div class="viewcode-block" id="Space.reorder_by_indices"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.reorder_by_indices">[docs]</a>    <span class="k">def</span> <span class="nf">reorder_by_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]):</span>
        <span class="sd">&quot;&quot;&quot;Return a :py:class:`~zfit.Space` reordered by the indices.</span>

<span class="sd">        Args:</span>
<span class="sd">            indices ():</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_reorder_limits</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_reorder_axes</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_reorder_obs</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">indices</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_space</span></div>

    <span class="k">def</span> <span class="nf">_reorder_limits</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeReturn</span><span class="p">:</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">limits</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">lower</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span> <span class="k">for</span> <span class="n">lower</span> <span class="ow">in</span> <span class="n">lower</span><span class="p">)</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">upper</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span> <span class="k">for</span> <span class="n">upper</span> <span class="ow">in</span> <span class="n">upper</span><span class="p">)</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span>

        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_limits</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="k">return</span> <span class="n">limits</span>

    <span class="k">def</span> <span class="nf">_reorder_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeReturn</span><span class="p">:</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">axes</span>
        <span class="k">return</span> <span class="n">axes</span>

    <span class="k">def</span> <span class="nf">_reorder_obs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indices</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">],</span> <span class="n">inplace</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeReturn</span><span class="p">:</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">obs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">indices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">inplace</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_obs</span> <span class="o">=</span> <span class="n">obs</span>
        <span class="k">return</span> <span class="n">obs</span>

<div class="viewcode-block" id="Space.get_obs_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.get_obs_axes">[docs]</a>    <span class="k">def</span> <span class="nf">get_obs_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">ObsNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Obs not specified, cannot create `obs_axes`&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">AxesNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Axes not specified, cannot create `obs_axes`&quot;</span><span class="p">)</span>

        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_obs</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_axes</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">OverdefinedError</span><span class="p">(</span><span class="s2">&quot;Cannot use `obs` and `axes` to define which subset to access.&quot;</span><span class="p">)</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obs</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">axes</span>
        <span class="c1"># only membership testing below</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span>

        <span class="c1"># create obs_axes dict</span>
        <span class="n">obs_axes</span> <span class="o">=</span> <span class="n">OrderedDict</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span> <span class="ow">or</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">obs_axes</span></div>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">obs_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># TODO(Mayou36): what if axes is None?</span>
        <span class="k">return</span> <span class="n">OrderedDict</span><span class="p">((</span><span class="n">o</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">_set_obs_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_axes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">allow_subset</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;(Reorder) set the observables and the `axes`.</span>

<span class="sd">        Temporarily if used with a context manager.</span>

<span class="sd">        Args:</span>
<span class="sd">            obs_axes (OrderedDict[str, int]): An (ordered) dict with {obs: axes}.</span>
<span class="sd">            allow_subset ():</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">ordered</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs_axes</span><span class="p">,</span> <span class="n">OrderedDict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="n">IntentionNotUnambiguousError</span><span class="p">(</span><span class="s2">&quot;`ordered` is True but not an `OrderedDict` was given.&quot;</span>
                                               <span class="s2">&quot;Error due to safety (in Python &lt;3.7, dicts are not guaranteed to be&quot;</span>
                                               <span class="s2">&quot;ordered).&quot;</span><span class="p">)</span>
        <span class="n">tmp_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
        <span class="n">self_obs_set</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">tmp_obs</span><span class="p">)</span>
        <span class="n">tmp_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span>
        <span class="n">self_axes_set</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">tmp_axes</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ordered</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># if not frozenset(obs_axes.keys()) &lt;= self_obs_set:</span>
                <span class="c1">#     raise ValueError(&quot;TODO observables not contained&quot;)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_subset</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">self_obs_set</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;subset not allowed but `obs` is only a subset of `self.obs`&quot;</span><span class="p">)</span>
                <span class="n">permutation_index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs_axes</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">self_obs_set</span><span class="p">)</span>  <span class="c1"># the future index of the space</span>
                <span class="n">self_axes_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">obs_axes</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&lt;=</span> <span class="n">self_axes_set</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;TODO axes not contained&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_subset</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">self_axes_set</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;subset not allowed but `axes` is only a subset of `self.axes`&quot;</span><span class="p">)</span>
                <span class="n">permutation_index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span>
                    <span class="n">ax</span> <span class="ow">in</span> <span class="n">self_axes_set</span><span class="p">)</span>  <span class="c1"># the future index of the space</span>
                <span class="n">self_obs_set</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">assert</span> <span class="kc">False</span><span class="p">,</span> <span class="s2">&quot;This should never be reached.&quot;</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reorder_limits</span><span class="p">(</span><span class="n">indices</span><span class="o">=</span><span class="n">permutation_index</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">obs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">o</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="k">if</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">self_obs_set</span><span class="p">)</span>
            <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">ax</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">()</span> <span class="k">if</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">self_axes_set</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_subset</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">self_obs_set</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;subset not allowed TODO&quot;</span><span class="p">)</span>
                <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">obs_axes</span><span class="p">[</span><span class="n">o</span><span class="p">]</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">)</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">allow_subset</span> <span class="ow">and</span> <span class="nb">frozenset</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">.</span><span class="n">values</span><span class="p">())</span> <span class="o">&lt;</span> <span class="n">self_axes_set</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;subset not allowed TODO&quot;</span><span class="p">)</span>
                <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>
                <span class="n">axes_obs</span> <span class="o">=</span> <span class="p">{</span><span class="n">v</span><span class="p">:</span> <span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">obs_axes</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
                <span class="n">obs</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">axes_obs</span><span class="p">[</span><span class="n">ax</span><span class="p">]</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either `obs` or `axes` have to be specified if the `obs_axes` dict&quot;</span>
                                 <span class="s2">&quot;is not ordered and `ordered` is False.&quot;</span><span class="p">)</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">limits</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">axes</span>

        <span class="k">def</span> <span class="nf">setter</span><span class="p">(</span><span class="n">arguments</span><span class="p">):</span>
            <span class="n">limits</span><span class="p">,</span> <span class="n">obs</span><span class="p">,</span> <span class="n">axes</span> <span class="o">=</span> <span class="n">arguments</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">_obs</span> <span class="o">=</span> <span class="n">obs</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_axes</span> <span class="o">=</span> <span class="n">axes</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_check_set_limits</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">getter</span><span class="p">():</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span>

        <span class="k">return</span> <span class="n">TemporarilySet</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">value</span><span class="p">,</span> <span class="n">setter</span><span class="o">=</span><span class="n">setter</span><span class="p">,</span> <span class="n">getter</span><span class="o">=</span><span class="n">getter</span><span class="p">)</span>

<div class="viewcode-block" id="Space.with_obs_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.with_obs_axes">[docs]</a>    <span class="k">def</span> <span class="nf">with_obs_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs_axes</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">]],</span> <span class="n">ordered</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
                      <span class="n">allow_subset</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a new :py:class:`~zfit.Space` with reordered observables and set the `axes`.</span>


<span class="sd">        Args:</span>
<span class="sd">            obs_axes (OrderedDict[str, int]): An ordered dict with {obs: axes}.</span>
<span class="sd">            ordered (bool): If True (and the `obs_axes` is an `OrderedDict`), the</span>
<span class="sd">            allow_subset ():</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">)</span>
        <span class="n">new_space</span><span class="o">.</span><span class="n">_set_obs_axes</span><span class="p">(</span><span class="n">obs_axes</span><span class="o">=</span><span class="n">obs_axes</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="n">ordered</span><span class="p">,</span> <span class="n">allow_subset</span><span class="o">=</span><span class="n">allow_subset</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.with_autofill_axes"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.with_autofill_axes">[docs]</a>    <span class="k">def</span> <span class="nf">with_autofill_axes</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">overwrite</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return a :py:class:`~zfit.Space` with filled axes corresponding to range(len(n_obs)).</span>

<span class="sd">        Args:</span>
<span class="sd">            overwrite (bool): If `self.axes` is not None, replace the axes with the autofilled ones.</span>
<span class="sd">                If axes is already set, don&#39;t do anything if `overwrite` is False.</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">overwrite</span><span class="p">:</span>
            <span class="n">new_axes</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">n_obs</span><span class="p">))</span>
            <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">new_axes</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_space</span> <span class="o">=</span> <span class="bp">self</span>

        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.area"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.area">[docs]</a>    <span class="k">def</span> <span class="nf">area</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Return the total area of all the limits and axes. Useful, for example, for MC integration.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">iter_areas</span><span class="p">(</span><span class="n">rel</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span></div>

<div class="viewcode-block" id="Space.iter_areas"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.iter_areas">[docs]</a>    <span class="k">def</span> <span class="nf">iter_areas</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rel</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return the areas of each interval</span>

<span class="sd">        Args:</span>
<span class="sd">            rel (bool): If True, return the relative fraction of each interval</span>
<span class="sd">        Returns:</span>
<span class="sd">            Tuple[float]:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">areas</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_calculate_areas</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">rel</span><span class="p">:</span>
            <span class="n">areas</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
            <span class="n">areas</span> <span class="o">/=</span> <span class="n">areas</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
            <span class="n">areas</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">areas</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">areas</span></div>

    <span class="nd">@staticmethod</span>
    <span class="nd">@functools</span><span class="o">.</span><span class="n">lru_cache</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">_calculate_areas</span><span class="p">(</span><span class="n">limits</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="n">areas</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">up</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">low</span><span class="p">)))</span> <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">up</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="o">*</span><span class="n">limits</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">areas</span>

<div class="viewcode-block" id="Space.get_subspace"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.get_subspace">[docs]</a>    <span class="k">def</span> <span class="nf">get_subspace</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obs</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a :py:class:`~zfit.Space` consisting of only a subset of the `obs`/`axes` (only one allowed).</span>

<span class="sd">        Args:</span>
<span class="sd">            obs (str, Tuple[str]):</span>
<span class="sd">            axes (int, Tuple[int]):</span>
<span class="sd">            name ():</span>

<span class="sd">        Returns:</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Cannot specify `obs` *and* `axes` to get subspace.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Either `obs` or `axes` has to be specified and not None&quot;</span><span class="p">)</span>

        <span class="c1"># try to use observables to get index</span>
        <span class="n">obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_obs</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sub_index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original message: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Cannot get subspace from `obs` </span><span class="si">{}</span><span class="s2"> as this observables are not defined&quot;</span>
                               <span class="s2">&quot;in this space. Only </span><span class="si">{}</span><span class="s2"> is defined.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">obs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">),</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">)))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>  <span class="c1"># `obs` is None -&gt; has not attribute `index`</span>
                <span class="k">raise</span> <span class="n">ObsNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Observables have not been specified in this space.&quot;</span><span class="p">)</span>

        <span class="c1"># try to use axes to get index</span>
        <span class="n">axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_check_convert_input_axes</span><span class="p">(</span><span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">allow_none</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">sub_index</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span> <span class="k">for</span> <span class="n">ax</span> <span class="ow">in</span> <span class="n">axes</span><span class="p">)</span>

            <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original message: &quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Cannot get subspace from `axes` </span><span class="si">{}</span><span class="s2"> as this axes are not defined&quot;</span>
                               <span class="s2">&quot;in this space. Only the following axes are </span><span class="si">{}</span><span class="s2">&quot;</span>
                               <span class="s2">&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">axes</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">))</span>
            <span class="k">except</span> <span class="ne">AttributeError</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">AxesNotSpecifiedError</span><span class="p">(</span><span class="s2">&quot;Axes have not been specified for this space.&quot;</span><span class="p">)</span>

        <span class="n">sub_obs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sub_index</span><span class="p">)</span>
        <span class="n">sub_axes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sub_index</span><span class="p">)</span>

        <span class="c1"># use index to get limits</span>
        <span class="n">limits</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">sub_limits</span> <span class="o">=</span> <span class="n">limits</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="o">=</span> <span class="n">limits</span>
            <span class="n">sub_lower</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">lim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sub_index</span><span class="p">)</span> <span class="k">for</span> <span class="n">lim</span> <span class="ow">in</span> <span class="n">lower</span><span class="p">)</span>
            <span class="n">sub_upper</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">lim</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">sub_index</span><span class="p">)</span> <span class="k">for</span> <span class="n">lim</span> <span class="ow">in</span> <span class="n">upper</span><span class="p">)</span>
            <span class="n">sub_limits</span> <span class="o">=</span> <span class="n">sub_lower</span><span class="p">,</span> <span class="n">sub_upper</span>

        <span class="n">new_space</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">sub_obs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">sub_axes</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">sub_limits</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">new_space</span></div>

    <span class="c1"># Operators</span>

<div class="viewcode-block" id="Space.copy"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.copy">[docs]</a>    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">overwrite_kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;zfit.Space&quot;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Create a new :py:class:`~zfit.Space` using the current attributes and overwriting with</span>
<span class="sd">        `overwrite_overwrite_kwargs`.</span>

<span class="sd">        Args:</span>
<span class="sd">            name (str): The new name. If not given, the new instance will be named the same as the</span>
<span class="sd">                current one.</span>
<span class="sd">            **overwrite_kwargs ():</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">name</span>

        <span class="n">kwargs</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="n">name</span><span class="p">,</span>
                  <span class="s1">&#39;limits&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span><span class="p">,</span>
                  <span class="s1">&#39;axes&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">,</span>
                  <span class="s1">&#39;obs&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">}</span>
        <span class="n">kwargs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">overwrite_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="n">overwrite_kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="s2">&quot;Not usable keys in `overwrite_kwargs`: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">overwrite_kwargs</span><span class="p">)</span> <span class="o">-</span> <span class="nb">set</span><span class="p">(</span><span class="n">kwargs</span><span class="p">)))</span>

        <span class="n">new_space</span> <span class="o">=</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

    <span class="k">def</span> <span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)):</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>
        <span class="n">axes_not_none</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="n">obs_not_none</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">other</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">axes_not_none</span> <span class="ow">or</span> <span class="n">obs_not_none</span><span class="p">):</span>  <span class="c1"># if both are None</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">axes_not_none</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">axes</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="n">obs_not_none</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">set</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">set</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">obs</span><span class="p">):</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="c1"># check limits</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">other</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">False</span>

        <span class="n">reorder_indices</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">get_reorder_indices</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">other</span><span class="o">.</span><span class="n">reorder_by_indices</span><span class="p">(</span><span class="n">reorder_indices</span><span class="p">)</span>

        <span class="c1"># check explicitly if they match</span>
        <span class="c1"># for each limit in self, find another matching in other</span>
        <span class="k">for</span> <span class="n">lower</span><span class="p">,</span> <span class="n">upper</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">iter_limits</span><span class="p">(</span><span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
            <span class="n">limit_is_le</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">other_lower</span><span class="p">,</span> <span class="n">other_upper</span> <span class="ow">in</span> <span class="n">other</span><span class="o">.</span><span class="n">iter_limits</span><span class="p">(</span><span class="n">as_tuple</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
                <span class="c1"># each entry *has to* match the entry of the other limit, otherwise it&#39;s not the same</span>
                <span class="k">for</span> <span class="n">low</span><span class="p">,</span> <span class="n">up</span><span class="p">,</span> <span class="n">other_low</span><span class="p">,</span> <span class="n">other_up</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">,</span> <span class="n">other_lower</span><span class="p">,</span> <span class="n">other_upper</span><span class="p">):</span>
                    <span class="n">axis_le</span> <span class="o">=</span> <span class="mi">0</span>  <span class="c1"># False</span>
                    <span class="n">axis_le</span> <span class="o">+=</span> <span class="n">other_low</span> <span class="o">==</span> <span class="n">low</span> <span class="ow">and</span> <span class="n">up</span> <span class="o">==</span> <span class="n">other_up</span>  <span class="c1"># TODO: approx limit comparison?</span>
                    <span class="n">axis_le</span> <span class="o">+=</span> <span class="n">other_low</span> <span class="o">==</span> <span class="n">low</span> <span class="ow">and</span> <span class="n">other_up</span> <span class="ow">is</span> <span class="n">ANY_UPPER</span>  <span class="c1"># TODO: approx limit</span>
                    <span class="c1"># comparison?</span>
                    <span class="n">axis_le</span> <span class="o">+=</span> <span class="n">other_low</span> <span class="ow">is</span> <span class="n">ANY_LOWER</span> <span class="ow">and</span> <span class="n">up</span> <span class="o">==</span> <span class="n">other_up</span>  <span class="c1"># TODO: approx limit</span>
                    <span class="c1"># comparison?</span>
                    <span class="n">axis_le</span> <span class="o">+=</span> <span class="n">other_low</span> <span class="ow">is</span> <span class="n">ANY_LOWER</span> <span class="ow">and</span> <span class="n">other_up</span> <span class="ow">is</span> <span class="n">ANY_UPPER</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="n">axis_le</span><span class="p">:</span>  <span class="c1"># if not the same, don&#39;t test other dims</span>
                        <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">limit_is_le</span> <span class="o">=</span> <span class="kc">True</span>  <span class="c1"># no break -&gt; all axes coincide</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">limit_is_le</span><span class="p">:</span>  <span class="c1"># for this `limit`, no other_limit matched</span>
                <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>

<div class="viewcode-block" id="Space.add"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.add">[docs]</a>    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">SpaceOrSpacesTypeInput</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add the limits of the spaces. Only works for the same obs.</span>

<span class="sd">        In case the observables are different, the order of the first space is taken.</span>

<span class="sd">        Args:</span>
<span class="sd">            other (:py:class:`~zfit.Space`):</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="n">add_spaces</span><span class="p">([</span><span class="bp">self</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

<div class="viewcode-block" id="Space.combine"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.Space.combine">[docs]</a>    <span class="k">def</span> <span class="nf">combine</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="n">ztyping</span><span class="o">.</span><span class="n">SpaceOrSpacesTypeInput</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">ZfitSpace</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Combine spaces with different obs (but consistent limits).</span>

<span class="sd">        Args:</span>
<span class="sd">            other (:py:class:`~zfit.Space`):</span>

<span class="sd">        Returns:</span>
<span class="sd">            :py:class:`~zfit.Space`:</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">other</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
        <span class="n">new_space</span> <span class="o">=</span> <span class="n">combine_spaces</span><span class="p">([</span><span class="bp">self</span><span class="p">]</span> <span class="o">+</span> <span class="n">other</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">new_space</span></div>

    <span class="k">def</span> <span class="fm">__add__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ZfitSpace</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot add a </span><span class="si">{}</span><span class="s2"> and a </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__mul__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">ZfitSpace</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s2">&quot;Cannot combine a </span><span class="si">{}</span><span class="s2"> and a </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">),</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">combine</span><span class="p">(</span><span class="n">other</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__ge__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">other</span><span class="o">.</span><span class="fm">__le__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">other</span><span class="p">)):</span>  <span class="c1"># TODO(Mayou36): what is a proper comparison?</span>
            <span class="k">return</span> <span class="bp">NotImplemented</span>

        <span class="n">is_eq</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">is_eq</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">obs</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">obs</span>
        <span class="n">is_eq</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">axes</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">other</span><span class="o">.</span><span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span>
        <span class="n">is_eq</span> <span class="o">*=</span> <span class="bp">self</span><span class="o">.</span><span class="n">limits</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">limits</span>
        <span class="k">return</span> <span class="nb">bool</span><span class="p">(</span><span class="n">is_eq</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__hash__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">lower</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lower</span>
        <span class="n">upper</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">upper</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">lower</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">lower</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>  <span class="c1"># we want to be non-restrictive: it&#39;s just a hash, not the __eq__</span>
            <span class="n">lower</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span> <span class="k">for</span> <span class="n">lim</span> <span class="ow">in</span> <span class="n">lower</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">upper</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">upper</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">upper</span> <span class="o">=</span> <span class="nb">frozenset</span><span class="p">(</span><span class="nb">frozenset</span><span class="p">(</span><span class="n">lim</span><span class="p">)</span> <span class="k">for</span> <span class="n">lim</span> <span class="ow">in</span> <span class="n">upper</span><span class="p">)</span>

        <span class="k">return</span> <span class="nb">hash</span><span class="p">((</span><span class="n">lower</span><span class="p">,</span> <span class="n">upper</span><span class="p">))</span></div>


<div class="viewcode-block" id="convert_to_space"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.convert_to_space">[docs]</a><span class="k">def</span> <span class="nf">convert_to_space</span><span class="p">(</span><span class="n">obs</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">ObsTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">axes</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">AxesTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">limits</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">ztyping</span><span class="o">.</span><span class="n">LimitsTypeInput</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="o">*</span><span class="p">,</span> <span class="n">overwrite_limits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">one_dim_limits_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
                     <span class="n">simple_limits_only</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="n">Space</span><span class="p">,</span> <span class="nb">bool</span><span class="p">]:</span>
    <span class="sd">&quot;&quot;&quot;Convert *limits* to a :py:class:`~zfit.Space` object if not already None or False.</span>

<span class="sd">    Args:</span>
<span class="sd">        obs (Union[Tuple[float, float], :py:class:`~zfit.Space`]):</span>
<span class="sd">        limits ():</span>
<span class="sd">        axes ():</span>
<span class="sd">        overwrite_limits (bool): If `obs` or `axes` is a :py:class:`~zfit.Space` _and_ `limits` are given, return an instance</span>
<span class="sd">            of :py:class:`~zfit.Space` with the new limits. If the flag is `False`, the `limits` argument will be</span>
<span class="sd">            ignored if</span>
<span class="sd">        one_dim_limits_only (bool):</span>
<span class="sd">        simple_limits_only (bool):</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[:py:class:`~zfit.Space`, False, None]:</span>

<span class="sd">    Raises:</span>
<span class="sd">        OverdefinedError: if `obs` or `axes` is a :py:class:`~zfit.Space` and `axes` respectively `obs` is not `None`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">space</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="c1"># Test if already `Space` and handle</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">obs</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">axes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">OverdefinedError</span><span class="p">(</span><span class="s2">&quot;if `obs` is a `Space`, `axes` cannot be defined.&quot;</span><span class="p">)</span>
        <span class="n">space</span> <span class="o">=</span> <span class="n">obs</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">axes</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">obs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">OverdefinedError</span><span class="p">(</span><span class="s2">&quot;if `axes` is a `Space`, `obs` cannot be defined.&quot;</span><span class="p">)</span>
        <span class="n">space</span> <span class="o">=</span> <span class="n">axes</span>
    <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limits</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">limits</span>
    <span class="k">if</span> <span class="n">space</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># set the limits if given</span>
        <span class="k">if</span> <span class="n">limits</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="p">(</span><span class="n">overwrite_limits</span> <span class="ow">or</span> <span class="n">space</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">limits</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>  <span class="c1"># figure out if compatible if limits is `Space`</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">obs</span> <span class="o">==</span> <span class="n">space</span><span class="o">.</span><span class="n">obs</span> <span class="ow">or</span>
                        <span class="p">(</span><span class="n">limits</span><span class="o">.</span><span class="n">axes</span> <span class="o">==</span> <span class="n">space</span><span class="o">.</span><span class="n">axes</span> <span class="ow">and</span> <span class="n">limits</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">space</span><span class="o">.</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)):</span>
                    <span class="k">raise</span> <span class="n">IntentionNotUnambiguousError</span><span class="p">(</span>
                        <span class="s2">&quot;`obs`/`axes` is a `Space` as well as the `limits`, but the &quot;</span>
                        <span class="s2">&quot;obs/axes of them do not match&quot;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">limits</span> <span class="o">=</span> <span class="n">limits</span><span class="o">.</span><span class="n">limits</span>

            <span class="n">space</span> <span class="o">=</span> <span class="n">space</span><span class="o">.</span><span class="n">with_limits</span><span class="p">(</span><span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">space</span>

    <span class="c1"># space is None again</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="n">obs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">axes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
        <span class="c1"># check if limits are allowed</span>
        <span class="n">space</span> <span class="o">=</span> <span class="n">Space</span><span class="o">.</span><span class="n">_from_any</span><span class="p">(</span><span class="n">obs</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">axes</span><span class="o">=</span><span class="n">axes</span><span class="p">,</span> <span class="n">limits</span><span class="o">=</span><span class="n">limits</span><span class="p">)</span>  <span class="c1"># create and test if valid</span>
        <span class="k">if</span> <span class="n">one_dim_limits_only</span> <span class="ow">and</span> <span class="n">space</span><span class="o">.</span><span class="n">n_obs</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">space</span><span class="o">.</span><span class="n">limits</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LimitsUnderdefinedError</span><span class="p">(</span>
                <span class="s2">&quot;Limits more sophisticated than 1-dim cannot be auto-created from tuples. Use `Space` instead.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">simple_limits_only</span> <span class="ow">and</span> <span class="n">space</span><span class="o">.</span><span class="n">limits</span> <span class="ow">and</span> <span class="n">space</span><span class="o">.</span><span class="n">n_limits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">LimitsUnderdefinedError</span><span class="p">(</span><span class="s2">&quot;Limits with multiple limits cannot be auto-created&quot;</span>
                                          <span class="s2">&quot; from tuples. Use `Space` instead.&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">space</span></div>


<span class="k">def</span> <span class="nf">_reorder_indices</span><span class="p">(</span><span class="n">old</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">],</span> <span class="n">new</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">List</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">]:</span>
    <span class="n">new_indices</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">old</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="k">for</span> <span class="n">o</span> <span class="ow">in</span> <span class="n">new</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_indices</span>


<div class="viewcode-block" id="no_norm_range"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.no_norm_range">[docs]</a><span class="k">def</span> <span class="nf">no_norm_range</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorator: Catch the &#39;norm_range&#39; kwargs. If not None, raise NormRangeNotImplementedError.&quot;&quot;&quot;</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="s1">&#39;norm_range&#39;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">norm_range_index</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;norm_range&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">norm_range_index</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">new_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">norm_range</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;norm_range&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">norm_range</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
            <span class="n">norm_range_not_false</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">norm_range</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">norm_range</span><span class="o">.</span><span class="n">limits</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm_range_not_false</span> <span class="o">=</span> <span class="ow">not</span> <span class="p">(</span><span class="n">norm_range</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">norm_range</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">norm_range_index</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">norm_range_is_arg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">norm_range_index</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">norm_range_is_arg</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">kwargs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;norm_range&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># remove if in signature (= norm_range_index not None)</span>
        <span class="k">if</span> <span class="n">norm_range_not_false</span> <span class="ow">or</span> <span class="n">norm_range_is_arg</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NormRangeNotImplementedError</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_func</span></div>


<div class="viewcode-block" id="no_multiple_limits"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.no_multiple_limits">[docs]</a><span class="k">def</span> <span class="nf">no_multiple_limits</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Decorator: Catch the &#39;limits&#39; kwargs. If it contains multiple limits, raise MultipleLimitsNotImplementedError.&quot;&quot;&quot;</span>
    <span class="n">parameters</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">if</span> <span class="s1">&#39;limits&#39;</span> <span class="ow">in</span> <span class="n">keys</span><span class="p">:</span>
        <span class="n">limits_index</span> <span class="o">=</span> <span class="n">keys</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="s1">&#39;limits&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">func</span>  <span class="c1"># no limits as parameters -&gt; no problem</span>

    <span class="nd">@functools</span><span class="o">.</span><span class="n">wraps</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">new_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">limits_is_arg</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">args</span><span class="p">)</span> <span class="o">&gt;</span> <span class="n">limits_index</span>
        <span class="k">if</span> <span class="n">limits_is_arg</span><span class="p">:</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="n">limits_index</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">limits</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;limits&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">limits</span><span class="o">.</span><span class="n">n_limits</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">MultipleLimitsNotImplementedError</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_func</span></div>


<div class="viewcode-block" id="supports"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.supports">[docs]</a><span class="k">def</span> <span class="nf">supports</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">norm_range</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span> <span class="n">multiple_limits</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Decorator: Add (mandatory for some methods) on a method to control what it can handle.</span>

<span class="sd">    If any of the flags is set to False, it will check the arguments and, in case they match a flag</span>
<span class="sd">    (say if a *norm_range* is passed while the *norm_range* flag is set to `False`), it will</span>
<span class="sd">    raise a corresponding exception (in this example a `NormRangeNotImplementedError`) that will</span>
<span class="sd">    be catched by an earlier function that knows how to handle things.</span>

<span class="sd">    Args:</span>
<span class="sd">        norm_range (bool): If False, no norm_range argument will be passed through resp. will be `None`</span>
<span class="sd">        multiple_limits (bool): If False, only simple limits are to be expected and no iteration is</span>
<span class="sd">            therefore required.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">decorator_stack</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">multiple_limits</span><span class="p">:</span>
        <span class="n">decorator_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">no_multiple_limits</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">norm_range</span><span class="p">:</span>
        <span class="n">decorator_stack</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">no_norm_range</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">create_deco_stack</span><span class="p">(</span><span class="n">func</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">decorator</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="n">decorator_stack</span><span class="p">):</span>
            <span class="n">func</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span>
        <span class="n">func</span><span class="o">.</span><span class="n">__wrapped__</span> <span class="o">=</span> <span class="n">supports</span>
        <span class="k">return</span> <span class="n">func</span>

    <span class="k">return</span> <span class="n">create_deco_stack</span></div>


<div class="viewcode-block" id="convert_to_obs_str"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.convert_to_obs_str">[docs]</a><span class="k">def</span> <span class="nf">convert_to_obs_str</span><span class="p">(</span><span class="n">obs</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Convert `obs` to the list of obs, also if it is a :py:class:`~zfit.Space`.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">convert_to_container</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="n">obs</span><span class="p">,</span> <span class="n">container</span><span class="o">=</span><span class="nb">tuple</span><span class="p">)</span>
    <span class="n">new_obs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">ob</span> <span class="ow">in</span> <span class="n">obs</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ob</span><span class="p">,</span> <span class="n">Space</span><span class="p">):</span>
            <span class="n">new_obs</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">ob</span><span class="o">.</span><span class="n">obs</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_obs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ob</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">new_obs</span></div>


<div class="viewcode-block" id="contains_tensor"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.contains_tensor">[docs]</a><span class="k">def</span> <span class="nf">contains_tensor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="n">tensor_found</span> <span class="o">=</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">tf</span><span class="o">.</span><span class="n">Variable</span><span class="p">))</span>
    <span class="k">with</span> <span class="n">suppress</span><span class="p">(</span><span class="ne">TypeError</span><span class="p">):</span>

        <span class="k">for</span> <span class="n">obj</span> <span class="ow">in</span> <span class="nb">object</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">tensor_found</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">tensor_found</span> <span class="o">+=</span> <span class="n">contains_tensor</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">tensor_found</span></div>


<div class="viewcode-block" id="shape_np_tf"><a class="viewcode-back" href="../../../api/zfit.core.limits.html#zfit.shape_np_tf">[docs]</a><span class="k">def</span> <span class="nf">shape_np_tf</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">contains_tensor</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">tf</span><span class="o">.</span><span class="n">convert_to_tensor</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="o">.</span><span class="n">as_list</span><span class="p">())</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="nb">object</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">shape</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
        <br/>
        
      
    </p>
    <p>
        &copy; Copyright Copyright 2018, zfit.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.3.1.<br/>
    </p>
  </div>
</footer>
  </body>
</html>